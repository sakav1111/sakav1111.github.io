<!DOCTYPE html><html lang="en">
  <head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no"><title>SatyaCodes - SpringBoot - Security</title>

<meta name="description" content="Tutorials, Java Tutorials,DevOps Tutorials,Spring Tutorial,SpringBoot Tutorials, Docker,Chef,Jenkins,Git,BitBucket,Bamboo,AWS,Kubernetes,Puppet,Ansible,Nagios.">
<link rel="canonical" href="/springboot/springboot-security"><link rel="alternate" type="application/rss+xml" title="SatyaCodes" href="/feed.xml"><!-- start favicons snippet, use https://realfavicongenerator.net/ --><link rel="apple-touch-icon" sizes="180x180" href="/assets/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/favicon-16x16.png"><link rel="manifest" href="/assets/site.webmanifest"><link rel="mask-icon" href="/assets/safari-pinned-tab.svg" color="#fc4d50"><link rel="shortcut icon" href="/assets/favicon.ico">

<meta name="msapplication-TileColor" content="#ffc40d"><meta name="msapplication-config" content="/assets/browserconfig.xml">

<meta name="theme-color" content="#ffffff">
<!-- end favicons snippet -->
 <link rel="stylesheet" href="/assets/css/main.css"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.13/css/all.css" >
<!-- Begin Jekyll SEO tag v2.7.1 -->
<title>SpringBoot - Security | SatyaCodes</title>
<meta name="generator" content="Jekyll v4.2.0" />
<meta property="og:title" content="SpringBoot - Security" />
<meta name="author" content="Satya Kaveti" />
<meta property="og:locale" content="en" />
<meta name="description" content="Tutorials, Java Tutorials,DevOps Tutorials,Spring Tutorial,SpringBoot Tutorials, Docker,Chef,Jenkins,Git,BitBucket,Bamboo,AWS,Kubernetes,Puppet,Ansible,Nagios." />
<meta property="og:description" content="Tutorials, Java Tutorials,DevOps Tutorials,Spring Tutorial,SpringBoot Tutorials, Docker,Chef,Jenkins,Git,BitBucket,Bamboo,AWS,Kubernetes,Puppet,Ansible,Nagios." />
<meta property="og:site_name" content="SatyaCodes" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="SpringBoot - Security" />
<script type="application/ld+json">
{"author":{"@type":"Person","name":"Satya Kaveti"},"@type":"WebPage","description":"Tutorials, Java Tutorials,DevOps Tutorials,Spring Tutorial,SpringBoot Tutorials, Docker,Chef,Jenkins,Git,BitBucket,Bamboo,AWS,Kubernetes,Puppet,Ansible,Nagios.","url":"/springboot/springboot-security","headline":"SpringBoot - Security","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<!-- start custom head snippets -->

<!-- end custom head snippets --><script>(function() {
  window.isArray = function(val) {
    return Object.prototype.toString.call(val) === '[object Array]';
  };
  window.isString = function(val) {
    return typeof val === 'string';
  };

  window.hasEvent = function(event) {
    return 'on'.concat(event) in window.document;
  };

  window.isOverallScroller = function(node) {
    return node === document.documentElement || node === document.body || node === window;
  };

  window.isFormElement = function(node) {
    var tagName = node.tagName;
    return tagName === 'INPUT' || tagName === 'SELECT' || tagName === 'TEXTAREA';
  };

  window.pageLoad = (function () {
    var loaded = false, cbs = [];
    window.addEventListener('load', function () {
      var i;
      loaded = true;
      if (cbs.length > 0) {
        for (i = 0; i < cbs.length; i++) {
          cbs[i]();
        }
      }
    });
    return {
      then: function(cb) {
        cb && (loaded ? cb() : (cbs.push(cb)));
      }
    };
  })();
})();
(function() {
  window.throttle = function(func, wait) {
    var args, result, thisArg, timeoutId, lastCalled = 0;

    function trailingCall() {
      lastCalled = new Date;
      timeoutId = null;
      result = func.apply(thisArg, args);
    }
    return function() {
      var now = new Date,
        remaining = wait - (now - lastCalled);

      args = arguments;
      thisArg = this;

      if (remaining <= 0) {
        clearTimeout(timeoutId);
        timeoutId = null;
        lastCalled = now;
        result = func.apply(thisArg, args);
      } else if (!timeoutId) {
        timeoutId = setTimeout(trailingCall, remaining);
      }
      return result;
    };
  };
})();
(function() {
  var Set = (function() {
    var add = function(item) {
      var i, data = this._data;
      for (i = 0; i < data.length; i++) {
        if (data[i] === item) {
          return;
        }
      }
      this.size ++;
      data.push(item);
      return data;
    };

    var Set = function(data) {
      this.size = 0;
      this._data = [];
      var i;
      if (data.length > 0) {
        for (i = 0; i < data.length; i++) {
          add.call(this, data[i]);
        }
      }
    };
    Set.prototype.add = add;
    Set.prototype.get = function(index) { return this._data[index]; };
    Set.prototype.has = function(item) {
      var i, data = this._data;
      for (i = 0; i < data.length; i++) {
        if (this.get(i) === item) {
          return true;
        }
      }
      return false;
    };
    Set.prototype.is = function(map) {
      if (map._data.length !== this._data.length) { return false; }
      var i, j, flag, tData = this._data, mData = map._data;
      for (i = 0; i < tData.length; i++) {
        for (flag = false, j = 0; j < mData.length; j++) {
          if (tData[i] === mData[j]) {
            flag = true;
            break;
          }
        }
        if (!flag) { return false; }
      }
      return true;
    };
    Set.prototype.values = function() {
      return this._data;
    };
    return Set;
  })();

  window.Lazyload = (function(doc) {
    var queue = {js: [], css: []}, sources = {js: {}, css: {}}, context = this;
    var createNode = function(name, attrs) {
      var node = doc.createElement(name), attr;
      for (attr in attrs) {
        if (attrs.hasOwnProperty(attr)) {
          node.setAttribute(attr, attrs[attr]);
        }
      }
      return node;
    };
    var end = function(type, url) {
      var s, q, qi, cbs, i, j, cur, val, flag;
      if (type === 'js' || type ==='css') {
        s = sources[type], q = queue[type];
        s[url] = true;
        for (i = 0; i < q.length; i++) {
          cur = q[i];
          if (cur.urls.has(url)) {
            qi = cur, val = qi.urls.values();
            qi && (cbs = qi.callbacks);
            for (flag = true, j = 0; j < val.length; j++) {
              cur = val[j];
              if (!s[cur]) {
                flag = false;
              }
            }
            if (flag && cbs && cbs.length > 0) {
              for (j = 0; j < cbs.length; j++) {
                cbs[j].call(context);
              }
              qi.load = true;
            }
          }
        }
      }
    };
    var load = function(type, urls, callback) {
      var s, q, qi, node, i, cur,
        _urls = typeof urls === 'string' ? new Set([urls]) : new Set(urls), val, url;
      if (type === 'js' || type ==='css') {
        s = sources[type], q = queue[type];
        for (i = 0; i < q.length; i++) {
          cur = q[i];
          if (_urls.is(cur.urls)) {
            qi = cur;
            break;
          }
        }
        val = _urls.values();
        if (qi) {
          callback && (qi.load || qi.callbacks.push(callback));
          callback && (qi.load && callback());
        } else {
          q.push({
            urls: _urls,
            callbacks: callback ? [callback] : [],
            load: false
          });
          for (i = 0; i < val.length; i++) {
            node = null, url = val[i];
            if (s[url] === undefined) {
              (type === 'js' ) && (node = createNode('script', { src: url }));
              (type === 'css') && (node = createNode('link', { rel: 'stylesheet', href: url }));
              if (node) {
                node.onload = (function(type, url) {
                  return function() {
                    end(type, url);
                  };
                })(type, url);
                (doc.head || doc.body).appendChild(node);
                s[url] = false;
              }
            }
          }
        }
      }
    };
    return {
      js: function(url, callback) {
        load('js', url, callback);
      },
      css: function(url, callback) {
        load('css', url, callback);
      }
    };
  })(this.document);
})();
</script><script>
  (function() {
    var TEXT_VARIABLES = {
      version: '2.2.4',
      sources: {
        font_awesome: 'https://use.fontawesome.com/releases/v5.0.13/css/all.css',
        jquery: 'https://cdn.bootcss.com/jquery/3.1.1/jquery.min.js',
        leancloud_js_sdk: '//cdn.jsdelivr.net/npm/leancloud-storage@3.13.2/dist/av-min.js',
        chart: 'https://cdn.bootcss.com/Chart.js/2.7.2/Chart.bundle.min.js',
        gitalk: {
          js: 'https://cdn.bootcss.com/gitalk/1.2.2/gitalk.min.js',
          css: 'https://cdn.bootcss.com/gitalk/1.2.2/gitalk.min.css'
        },
        valine: 'https://unpkg.com/valine/dist/Valine.min.js',
        mathjax: 'https://cdn.bootcss.com/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_CHTML',
        mermaid: 'https://cdn.bootcss.com/mermaid/8.0.0-rc.8/mermaid.min.js'
      },
      site: {
        toc: {
          selectors: 'h1,h2,h3'
        }
      },
      paths: {
        search_js: '/assets/search.js'
      }
    };
    window.TEXT_VARIABLES = TEXT_VARIABLES;
  })();
</script></head>
  <body>
    <div class="root" data-is-touch="false">
      <div class="layout--page layout--page--sidebar clearfix js-page-root">
  <div class="page__mask d-print-none js-page-mask js-sidebar-hide"></div>
  <div class="page__viewport">
    <div class="page__actions d-print-none">
      <div class="button button--circle button--lg box-shadow-2 sidebar-button js-sidebar-show">
        <i class="fas fa-bars icon--show"></i>
      </div>
    </div>

    <div class="grid page__grid">

      <div class="page__sidebar d-print-none"><div class="sidebar-toc"><ul class="toc toc--navigator"><li class="toc-h1">SpringBoot Tutorial</li><li class="toc-h2"><a href="/springboot/introduction">Introduction</a></li><li class="toc-h2"><a href="/springboot/creating-springboot-application">Creating SpringBoot Application</a></li><li class="toc-h2"><a href="/springboot/springboot-with-maven">SpringBoot with Maven</a></li><li class="toc-h2"><a href="/springboot/springboot-with-spring-initializer">SpringBoot with Spring Initializer</a></li><li class="toc-h2"><a href="/springboot/springboot-configurations">SpringBoot Configurations</a></li><li class="toc-h2"><a href="/springboot/springboot-mvc">SpringBoot MVC</a></li><li class="toc-h2"><a href="/springboot/springboot-restful">SpringBoot RESTful</a></li><li class="toc-h2"><a href="/springboot/springboot-database">SpringBoot Database</a></li><li class="toc-h2"><a href="/springboot/springboot-jpa-example">SpringBoot JPA Example</a></li><li class="toc-h2"><a href="/springboot/springboot-jparepository">SpringBoot JpaRepository</a></li><li class="toc-h2"><a href="/springboot/springboot-mongodb-and-rest-example">SpringBoot MongoDB and REST Example</a></li><li class="toc-h2"><a href="/springboot/springboot-advanced">SpringBoot Advanced</a></li><li class="toc-h2 active"><a href="/springboot/springboot-security">SpringBoot Security</a></li><li class="toc-h2"><a href="/springboot/springboot-microservices">SpringBoot Microservices</a></li></ul></div></div><div class="page__main js-page-main has-aside cell cell--auto">

      <div class="page__main-inner"><div class="page__header d-print-none"><header class="header"><div class="main">
      <div class="header__title">
        <div class="header__brand"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="76px" height="76px" viewBox="0 0 76 76" enable-background="new 0 0 76 76" xml:space="preserve">  <image id="image0" width="76" height="76" x="0" y="0"
    xlink:href="data:image/png;base64,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" />
</svg>
<a title="Tutorials, Java Tutorials,DevOps Tutorials,Spring Tutorial,SpringBoot Tutorials, Docker,Chef,Jenkins,Git,BitBucket,Bamboo,AWS,Kubernetes,Puppet,Ansible,Nagios." href="/">SatyaCodes</a></div><button class="button button--secondary button--circle search-button js-search-toggle"><i class="fas fa-search"></i></button></div><nav class="navigation">
        <ul><li class="navigation__item"><a href="/posts.html">AllPosts</a></li><li class="navigation__item"><a href="/tutorials.html">Tutorials</a></li><li class="navigation__item"><a href="/java.html">Java</a></li><li class="navigation__item"><a href="/devops.html">DevOps</a></li><li class="navigation__item"><a href="/books.html">Books</a></li><li class="navigation__item"><a href="/interview-questions.html">InterviewQ's</a></li><li><button class="button button--secondary button--circle search-button js-search-toggle"><i class="fas fa-search"></i></button></li></ul>
      </nav></div>
  </header>
</div><div class="page__content"><div class ="main"><div class="grid grid--reverse">

              <div class="col-aside d-print-none js-col-aside"><aside class="page__aside js-page-aside"><div class="toc-aside js-toc-root"></div></aside></div>

              <div class="col-main cell cell--auto"><!-- start custom main top snippet -->

<!-- end custom main top snippet --><article itemscope itemtype="http://schema.org/Article"><div class="article__header"><header><h1>SpringBoot - Security</h1></header></div><meta itemprop="headline" content="SpringBoot - Security"><div class="article__info clearfix"><ul class="left-col menu"><li>
              <a class="button button--secondary button--pill button--sm"
                href="/archive.html?tag=SpringBoot">SpringBoot</a>
            </li></ul></div><meta itemprop="author" content="Satya Kaveti"/>
    <meta itemprop="keywords" content="SpringBoot"><div class="js-article-content"><div class="layout--article"><!-- start custom article top snippet -->

<!-- end custom article top snippet --><div class="article__content" itemprop="articleBody"><h1 id="7-springboot---security">7. SpringBoot - Security</h1>

<p>Spring Security is a framework that focuses on providing both <strong>authentication</strong>
and <strong>authorization</strong> (or -access-control”) to Java web application and
SOAP/RESTful web services.</p>

<p>Spring Security currently supports integration with all of the following
technologies:</p>

<ul>
  <li>
    <p><strong>HTTP</strong> basic access authentication</p>
  </li>
  <li>
    <p><strong>LDAP</strong> system</p>
  </li>
  <li>
    <p><strong>OpenID</strong> identity providers – Google, Facebook etc</p>
  </li>
  <li>
    <p><strong>JAAS</strong> API: JAAS stands for Java Authentication and Authorization Service.
This is a pluggable module which is implemented in Java and the Spring
Security Framework uses it for its authentication purposes.</p>
  </li>
  <li>
    <p><strong>Single Sign-On</strong>: This allows the user to get access to multiple
applications with only one account (username and password).</p>
  </li>
  <li>
    <p>CAS Server</p>
  </li>
  <li>
    <p>ESB Platform</p>
  </li>
  <li>
    <p>Your own authentication systems</p>
  </li>
</ul>

<p><br /></p>

<p><br /></p>

<h2 id="spring-security-architecture">Spring Security Architecture</h2>

<p><em>Spring security</em> comes with a set of security filters. Each request to the
server is intercepted by these filters. These filters will process the request
based on the logic and will <strong>pass or reject</strong> the incoming request, let’s look
at the distinct steps of the <em>authentication process</em>.</p>

<p><img src="media/55fec23c8a9e96157d7c46fe25385900.png" alt="" /></p>

<p><br /></p>

<h4 id="1-incoming-http-request">1. Incoming HTTP Request</h4>

<p>Each incoming request will go through a chain of <em>filters for authentication and
authorization</em> process. Look at the step 1 in above diagram, each request is
passing through the security filter chain. Keep in mind the following points.</p>

<ul>
  <li>
    <p>Each request will pass through the <strong>filters</strong> until it reaches relevant
authentication filter.</p>
  </li>
  <li>
    <p>Each request can go through a distinct set of security filters. We can
configure filters by request patterns or even based on the request headers.</p>
  </li>
  <li>
    <p>In above diagram, login request goes through the filter chains and reaches
to the <strong>UsernamePasswordAuthenticationFilter</strong>.</p>
  </li>
  <li>
    <p>Similarly, a basic authentication request goes through the chains of filters
until it reaches <strong>BasicAuthenticationFilter</strong>.</p>
  </li>
</ul>

<p><br /></p>

<h4 id="2-authenticationtoken-based-on-user-credentials">2. AuthenticationToken Based on User Credentials</h4>

<p>For the user login, once the <em>authentication request</em> reached the authentication
filter, it will extract the username and password from the request payload.
Spring security will create an Authentication object based on the username and
password. This is how the Authentication objection creation look like:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">UsernamePasswordAuthenticationToken</span> <span class="n">authentication</span>
<span class="o">=</span> <span class="k">new</span> <span class="nc">UsernamePasswordAuthenticationToken</span><span class="o">(</span><span class="n">username</span><span class="o">,</span> <span class="n">password</span><span class="o">);</span>
</code></pre></div></div>

<p><br /></p>

<h4 id="3-authentication-manager">3. Authentication Manager</h4>

<p><em>Authentication Manager</em> is the core for the <em>Spring security authentication
process</em>. <strong>AuthenticationManager</strong> is the API that defines how <em>Spring
Security’s Filters perform authentication</em>.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">AuthenticationManager</span> <span class="o">{</span>

<span class="nc">Authentication</span> <span class="nf">authenticate</span><span class="o">(</span><span class="nc">Authentication</span> <span class="n">authentication</span><span class="o">)</span>
<span class="n">throwsAuthenticationException</span><span class="o">;</span>

<span class="o">}</span>
</code></pre></div></div>

<p>Before we move ahead, let’s cover important points for the
AuthenticationManager.</p>

<ol>
  <li>
    <p>Internally the AuthenticationProvider responsible to perform the
authentication process.</p>
  </li>
  <li>
    <p>ProviderManager manager is the most used implementation of
AuthenticationProvider.</p>
  </li>
  <li>
    <p>ProviderManager delegates the request to the list of AuthenticationProvider.</p>
  </li>
</ol>

<p><br /></p>

<h4 id="4-authenticationproviders">4. AuthenticationProviders</h4>

<p>The AuthenticationProvider are responsible to process the request and perform a
specific authentication. It provides a mechanism for getting the user details
with which we can perform authentication. This is how the AuthenticationProvider
interface looks like:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">AuthenticationProvider</span> <span class="o">{</span>

<span class="nc">Authentication</span> <span class="nf">authenticate</span><span class="o">(</span><span class="nc">Authentication</span> <span class="n">authentication</span><span class="o">)</span> <span class="kd">throws</span>
<span class="nc">AuthenticationException</span><span class="o">;</span>

<span class="kt">boolean</span> <span class="nf">supports</span><span class="o">(</span><span class="nc">Class</span> <span class="o">&lt;?&gt;</span> <span class="n">authentication</span><span class="o">);</span>

<span class="o">}</span>
</code></pre></div></div>

<p>Our AuthenticationProvider can’t execute directly but we can configure multiple
providers using the
AuthenticationProvider.<img src="media/58e35365d2ccdf89a5dd07cef06ae212.png" alt="" /></p>

<p>If you are curious, here is the list of some OOTB authentication providers.</p>

<ul>
  <li>
    <p>DaoAuthenticationProvider.</p>
  </li>
  <li>
    <p>JAAS Authentication</p>
  </li>
  <li>
    <p>OpenID Authentication</p>
  </li>
  <li>
    <p>X509 Authentication</p>
  </li>
  <li>
    <p>SAML 2.0</p>
  </li>
  <li>
    <p>OAuth 2.0</p>
  </li>
  <li>
    <p>RememberMeAuthenticationProvider</p>
  </li>
  <li>
    <p>LdapAuthenticationProvider</p>
  </li>
</ul>

<p><br /></p>

<h4 id="5-custom-authentication-provider">5. Custom Authentication Provider</h4>

<p>For enterprise applications, we may need a custom authentication provider.
Implement the <code class="language-plaintext highlighter-rouge">AuthenticationProvider</code> interface to create a custom authentication
provider for your application.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Component</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">CustomAuthenticationProvider</span> <span class="kd">implements</span> <span class="nc">AuthenticationProvider</span> <span class="o">{</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="nc">Authentication</span> <span class="nf">authenticate</span><span class="o">(</span><span class="nc">Authentication</span> <span class="n">auth</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">AuthenticationException</span> <span class="o">{</span>
      <span class="nc">String</span> <span class="n">username</span> <span class="o">=</span> <span class="n">authentication</span><span class="o">.</span><span class="na">getName</span><span class="o">();</span>
      <span class="nc">String</span> <span class="n">pwd</span> <span class="o">=</span> <span class="n">authentication</span><span class="o">.</span><span class="na">getCredentials</span><span class="o">().</span><span class="na">toString</span><span class="o">();</span>
      <span class="k">if</span> <span class="o">(</span><span class="s">"javadevjournal"</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">username</span><span class="o">)</span> <span class="o">&amp;&amp;</span> <span class="s">"pass"</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">pwd</span><span class="o">))</span> <span class="o">{</span>
            <span class="k">return</span> <span class="k">new</span> <span class="nf">UsernamePasswordAuthenticationToken</span><span class="o">(</span><span class="n">username</span><span class="o">,</span> <span class="n">password</span><span class="o">,</span> <span class="nc">Collections</span><span class="o">.</span><span class="na">emptyList</span><span class="o">());</span>
       <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">BadCredentialsException</span><span class="o">(</span><span class="s">"User authentication failed!!!!"</span><span class="o">);</span>
       <span class="o">}</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">supports</span><span class="o">(</span><span class="nc">Class</span><span class="o">&lt;?&gt;</span><span class="n">auth</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">auth</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="nc">UsernamePasswordAuthenticationToken</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>The last step is to configure our custom authentication provider with Spring
security. We do that by creating a custom configuration class and extending the
WebSecurityConfigurerAdapter.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Configuration</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">WebSecurityConfig</span> <span class="kd">extends</span> <span class="nc">WebSecurityConfigurerAdapter</span> <span class="o">{</span>

    <span class="nd">@Autowired</span>
    <span class="nc">CustomAuthenticationProvider</span> <span class="n">customAuthenticationProvider</span><span class="o">;</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">configure</span><span class="o">(</span><span class="nc">AuthenticationManagerBuilder</span> <span class="n">auth</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
        <span class="c1">//configuring our custom auth provider</span>
        <span class="n">auth</span><span class="o">.</span><span class="na">authenticationProvider</span><span class="o">(</span><span class="n">customAuthProvider</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p><br /></p>

<h4 id="6-spring-security-userdetailsservice">6. Spring Security UserDetailsService</h4>

<p>Not all, but few authentication providers may need <code class="language-plaintext highlighter-rouge">UserDetailsService</code> to get the
user details stored in the database by <code class="language-plaintext highlighter-rouge">username</code> (e.g.
DaoAuthenticationProvider). Most of the standard web application may use the
<code class="language-plaintext highlighter-rouge">UserDetailsService</code> to get user information during login process. This is how the
UserDetailsService interface look like:</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="nn">org.springframework.security.core.userdetails</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">UserDetailsService</span> <span class="o">{</span>
    <span class="nc">UserDetails</span> <span class="nf">loadUserByUsername</span><span class="o">(</span><span class="nc">String</span> <span class="n">var1</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">UsernameNotFoundException</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>

<p>It’s a common use case to define a <a href="https://www.javadevjournal.com/spring/spring-security-userdetailsservice/">custom
UserDetailsService</a>
for our application.</p>

<p><br /></p>

<h4 id="7-authentication-and-authentication-exception">7. Authentication and Authentication Exception</h4>

<p>During the authentication process, if the user authentication is successful, we
will send a fully initialized Authentication object back. For failed
authentication, AuthenticationException will be thrown. A fully populated
authentication object carries the following details:</p>

<ul>
  <li>
    <p>User credentials.</p>
  </li>
  <li>
    <p>List of granted authorities (for authorization).</p>
  </li>
  <li>
    <p>Authentication flag.</p>
  </li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">Authentication</span> <span class="kd">extends</span> <span class="nc">Principal</span><span class="o">,</span> <span class="nc">Serializable</span> <span class="o">{</span>
    <span class="nc">Collection</span><span class="o">&lt;?</span> <span class="kd">extends</span> <span class="nc">GrantedAuthority</span><span class="o">&gt;</span> <span class="nf">getAuthorities</span><span class="o">();</span>

    <span class="nc">Object</span> <span class="nf">getCredentials</span><span class="o">();</span>
    <span class="nc">Object</span> <span class="nf">getDetails</span><span class="o">();</span>
    <span class="nc">Object</span> <span class="nf">getPrincipal</span><span class="o">();</span>
    <span class="kt">boolean</span> <span class="nf">isAuthenticated</span><span class="o">();</span>
    <span class="kt">void</span> <span class="nf">setAuthenticated</span><span class="o">(</span><span class="kt">boolean</span> <span class="n">var1</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">IllegalArgumentException</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>

<p><br /></p>

<h4 id="8-setting-authentication-securitycontext">8. Setting Authentication SecurityContext</h4>

<p>The last step on the successful authentication is setting up the authentication
object in the SecurityContext. It wraps the SecurityContext around the
SecurityContextHolder. Keep in mind following points:</p>

<ul>
  <li>
    <p>SecurityContextHolder is where Spring Security stores the details about
authenticated users.</p>
  </li>
  <li>
    <p>Spring security will not validate how the SecurityContextHolder is
populated.</p>
  </li>
  <li>
    <p>If it finds values in the SecurityContextHolder, it assumes that current
user is an authenticated user.This is how the SecurityContextHolder
populates</p>
  </li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">SecurityContext</span> <span class="n">context</span> <span class="o">=</span> <span class="c1">//get the context from security holder</span>

<span class="nc">UsernamePasswordAuthenticationToken</span> <span class="n">authentication</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">UsernamePasswordAuthenticationToken</span><span class="o">(</span><span class="n">username</span><span class="o">,</span> <span class="n">password</span><span class="o">);</span>

<span class="n">context</span><span class="o">.</span><span class="na">setAuthentication</span><span class="o">(</span><span class="n">authentication</span><span class="o">);</span>
<span class="nc">SecurityContextHolder</span><span class="o">.</span><span class="na">setContext</span><span class="o">(</span><span class="n">context</span><span class="o">);</span>
</code></pre></div></div>

<p>Ref.:
<a href="https://www.javadevjournal.com/spring-security/spring-security-authentication/">https://www.javadevjournal.com/spring-security/spring-security-authentication/</a></p>

<p><img src="media/6a38b7d1c6442869f89dd3a14b726ad3.png" alt="" /></p>

<p><img src="media/a292f0053fa306ca2af5448e5ab44989.png" alt="" /></p>

<p><img src="media/133e479cd3febe205c2eaa74b2f57189.png" alt="" /></p>

<p><br /></p>

<p><br /></p>

<h2 id="spring-security-authentication-types">Spring Security Authentication Types</h2>

<ul>
  <li>
    <p>Web Security Authentication (@EnableWebSecurity)</p>

    <ol>
      <li>
        <p>Basic Authenication</p>
      </li>
      <li>
        <p>In-Memory Authentication</p>
      </li>
      <li>
        <p>JDBC Authentication</p>
      </li>
      <li>
        <p>LDAP Authentication</p>
      </li>
    </ol>
  </li>
  <li>
    <p>JWT(JSON Web Token) Authentication</p>
  </li>
  <li>
    <p>OAuth 2.0 SSO Authentication</p>
  </li>
  <li>
    <p>REST API</p>
  </li>
</ul>

<p><br /></p>

<p>With the latest Spring Security and/or Spring Boot versions, the way to
configure Spring Security is by having a class that:</p>

<ol>
  <li>
    <p>Is annotated with <strong>@EnableWebSecurity</strong>.</p>
  </li>
  <li>
    <p>Extends <strong>WebSecurityConfigurer</strong>, which basically offers you a
configuration DSL/method. With those methods, you can specify what URIs in
your application to protect or what exploit protections to enable/disable.</p>
  </li>
</ol>

<p>Here’s what a typical <strong>WebSecurityConfigurerAdapter</strong> looks like</p>

<p><br /></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Configuration</span>
<span class="nd">@EnableWebSecurity</span> <span class="c1">// (1)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">WebSecurityConfig</span> <span class="kd">extends</span> <span class="nc">WebSecurityConfigurerAdapter</span> <span class="o">{</span> <span class="c1">// (1)</span>

  <span class="nd">@Override</span>
  <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">configure</span><span class="o">(</span><span class="nc">HttpSecurity</span> <span class="n">http</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>  <span class="c1">// (2)</span>
      <span class="n">http</span>
        <span class="o">.</span><span class="na">authorizeRequests</span><span class="o">()</span>
          <span class="o">.</span><span class="na">antMatchers</span><span class="o">(</span><span class="s">"/"</span><span class="o">,</span> <span class="s">"/home"</span><span class="o">).</span><span class="na">permitAll</span><span class="o">()</span> <span class="c1">// (3)</span>
          <span class="o">.</span><span class="na">anyRequest</span><span class="o">().</span><span class="na">authenticated</span><span class="o">()</span> <span class="c1">// (4)</span>
          <span class="o">.</span><span class="na">and</span><span class="o">()</span>
       <span class="o">.</span><span class="na">formLogin</span><span class="o">()</span> <span class="c1">// (5)</span>
         <span class="o">.</span><span class="na">loginPage</span><span class="o">(</span><span class="s">"/login"</span><span class="o">)</span> <span class="c1">// (5)</span>
         <span class="o">.</span><span class="na">permitAll</span><span class="o">()</span>
         <span class="o">.</span><span class="na">and</span><span class="o">()</span>
      <span class="o">.</span><span class="na">logout</span><span class="o">()</span> <span class="c1">// (6)</span>
        <span class="o">.</span><span class="na">permitAll</span><span class="o">()</span>
        <span class="o">.</span><span class="na">and</span><span class="o">()</span>
      <span class="o">.</span><span class="na">httpBasic</span><span class="o">();</span> <span class="c1">// (7)</span>
  <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<ol>
  <li>
    <p>A normal Spring @Configuration with the @EnableWebSecurity annotation,
extending from <strong>WebSecurityConfigurerAdapter</strong>.</p>
  </li>
  <li>
    <p>By overriding the adapter’s <strong>configure(HttpSecurity)</strong> method, you get a
nice little DSL with which you can configure your FilterChain.</p>
  </li>
  <li>
    <p>All requests going to <strong>/ and /home</strong> are allowed (permitted) - the user
does <em>not</em> have to authenticate. You are using an
<a href="https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/util/AntPathMatcher.html">antMatcher</a>,
which means you could have also used wildcards (*, \*\*, ?) in the
string.</p>
  </li>
  <li>
    <p>Any other request needs the user to be authenticated first, i.e. the user
needs to login.</p>
  </li>
  <li>
    <p>You are allowing form login (username/password in a form), with a custom
loginPage (<em>/login</em>, i.e. not Spring Security’s auto-generated one). Anyone
should be able to access the login page, without having to log in first
(permitAll; otherwise, we would have a Catch-22!).</p>
  </li>
  <li>
    <p>The same goes for the logout page</p>
  </li>
  <li>
    <p>On top of that, you are also allowing Basic Auth, i.e. sending in an HTTP
Basic Auth Header to authenticate.</p>
  </li>
</ol>

<p><br /></p>

<p><br /></p>

<h2 id="1spring-security--quick-start-example">1.Spring Security – Quick Start Example</h2>

<p>We have SpringBoot Application, which doesn’t have login page. After running
application, it will show all Employees Page.</p>

<p><img src="media/777b642a9dd2bb5a3ac60d68c0c68f94.png" alt="" /></p>

<p>We are going to add Spring Security jar to this project.
spring-boot-starter-security: take care of all the required dependencies related
to spring security.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&lt;</span><span class="n">dependency</span><span class="o">&gt;</span>
   <span class="o">&lt;</span><span class="n">groupId</span><span class="o">&gt;</span><span class="n">org</span><span class="o">.</span><span class="na">springframework</span><span class="o">.</span><span class="na">boot</span><span class="o">&lt;/</span><span class="n">groupId</span><span class="o">&gt;</span>
   <span class="o">&lt;</span><span class="n">artifactId</span><span class="o">&gt;</span><span class="n">spring</span><span class="o">-</span><span class="n">boot</span><span class="o">-</span><span class="n">starter</span><span class="o">-</span><span class="n">security</span><span class="o">&lt;/</span><span class="n">artifactId</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">dependency</span><span class="o">&gt;</span>
</code></pre></div></div>

<p>This will include the <em>SecurityAutoConfiguration</em> class – containing the
initial/default security configuration.</p>

<p>Just Run the project &amp; see the magic – It will Directly open Login Page</p>

<p><img src="media/9bb3a365521d68a5e80ac6df2cff0e83.png" alt="" /></p>

<p><br /></p>

<p><strong>We never created this login form, but from where it came from?</strong></p>

<p>In our application, we did not create this login page but configured the Spring
Security. This is a built-in login page provided by the framework itself to
authenticate the user.SpringSecurity default comes with login page &amp; you can
login with generated password which is already printed in the console</p>
<pre><code class="language-node">Using generated security password: **8b4667a4-cc3a-47fd-b51f-b6f5e83745df**
Def.user name is: **user**
</code></pre>

<p>You can change the password by providing a security.user.password. This and
other useful properties are externalized via
<a href="https://github.com/spring-projects/spring-boot/tree/v1.4.0.RELEASE/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/security/SecurityProperties.java">SecurityProperties</a>
(properties prefix “security”).</p>
<pre><code class="language-node">security.user.name=user
security.user.name=password
security.basic.enabled=true
</code></pre>

<p><strong>Thus, by just adding the spring boot security starter dependency the basic
security has already been configured by default.</strong> Let’s customize the security
configuration by writing our own authorization and authentication. For this
create a new class SecurityConfig that extends the WebSecurityConfigurerAdapter
and overrides its methods.</p>

<p>To discard the security auto-configuration and add our own configuration, we
need to exclude the <strong>SecurityAutoConfiguration</strong> class.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@SpringBootApplication</span><span class="o">(</span><span class="n">exclude</span> <span class="o">=</span> <span class="o">{</span> <span class="nc">SecurityAutoConfiguration</span><span class="o">.</span><span class="na">class</span> <span class="o">})</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SpringBootSecurityApplication</span> <span class="o">{</span> 
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">SpringApplication</span><span class="o">.</span><span class="na">run</span><span class="o">(</span><span class="nc">SpringBootSecurityApplication</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">args</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>Or by adding some configuration into the <em>application.properties</em> file:</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">spring</span><span class="o">.</span><span class="na">autoconfigure</span><span class="o">.</span><span class="na">exclude</span><span class="o">=</span><span class="n">org</span><span class="o">.</span><span class="na">springframework</span><span class="o">.</span><span class="na">boot</span><span class="o">.</span><span class="na">autoconfigure</span><span class="o">.</span><span class="na">security</span><span class="o">.</span><span class="na">SecurityAutoConfiguration</span>
</code></pre></div></div>

<p><br /></p>

<p><br /></p>

<h2 id="2spring-security--basic--in-memory-authentication-example">2.Spring Security – Basic &amp; In-Memory Authentication Example</h2>

<p>If we are disabling security auto-configuration, we need to provide our own
configuration by creating new class annotated with <strong>@EnableWebSecurity</strong> which
extends <strong>WebSecurityConfigurerAdapter</strong>.</p>

<p>Spring Security provides HTTP basic authentication to authenticate the user at
the client-side and send the user credentials with the request header to the
server. The server receives these credentials, extract them from the header, and
map them with the existing record to validate the user.</p>

<p>The <strong>BasicAuthenticationFilter</strong> handles the request and check whether the
request contains an authentication header or not. The <code class="language-plaintext highlighter-rouge">httpBasic()</code> method enables
the Basic HTTP security in our application. Let’s create a project and
implements HTTP security.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Configuration</span>
<span class="nd">@EnableWebSecurity</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SecurityConfig</span> <span class="kd">extends</span> <span class="nc">WebSecurityConfigurerAdapter</span> <span class="o">{</span>

	<span class="nd">@Override</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">configure</span><span class="o">(</span><span class="nc">HttpSecurity</span> <span class="n">http</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
		<span class="c1">// It allows configuring web based security for specific http requests</span>
		<span class="n">http</span><span class="o">.</span><span class="na">authorizeRequests</span><span class="o">()</span>
            	<span class="o">.</span><span class="na">anyRequest</span><span class="o">().</span><span class="na">authenticated</span><span class="o">()</span> 
            	<span class="o">.</span><span class="na">and</span><span class="o">()</span>
        	<span class="o">.</span><span class="na">formLogin</span><span class="o">()</span>                      
            	<span class="o">.</span><span class="na">and</span><span class="o">()</span>
        	<span class="o">.</span><span class="na">httpBasic</span><span class="o">();</span>	<span class="c1">// This means it is Basic Authenication</span>
	<span class="o">}</span>

    <span class="nd">@Bean</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="nc">UserDetailsService</span> <span class="nf">userDetailsService</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">UserDetails</span> <span class="n">user</span> <span class="o">=</span>
             <span class="nc">User</span><span class="o">.</span><span class="na">withDefaultPasswordEncoder</span><span class="o">()</span>
                <span class="o">.</span><span class="na">username</span><span class="o">(</span><span class="s">"user"</span><span class="o">)</span>
                <span class="o">.</span><span class="na">password</span><span class="o">(</span><span class="s">"user"</span><span class="o">)</span>
                <span class="o">.</span><span class="na">roles</span><span class="o">(</span><span class="s">"USER"</span><span class="o">)</span>
                <span class="o">.</span><span class="na">build</span><span class="o">();</span>
 
        <span class="k">return</span> <span class="k">new</span> <span class="nf">InMemoryUserDetailsManager</span><span class="o">(</span><span class="n">user</span><span class="o">);</span> 
<span class="c1">// This means We probive User data using InMomory</span>
    <span class="o">}</span>	
<span class="o">}</span>
</code></pre></div></div>

<p>Here we provided Static user conntenet. This type of Authurization Known as In
Memory Authrization.</p>

<p>Let’s summarize what we did in order to add Spring Boot Security to his web app.
To secure his web app,</p>

<ul>
  <li>
    <p>we added Spring Boot Security to the classpath/maven.</p>
  </li>
  <li>
    <p>Once it was in the classpath, Spring Boot Security was enabled by default.</p>
  </li>
  <li>
    <p>Then customized the security by extending WebSecurityConfigurerAdapter and
added his own configure and userDetailsServiceimplementation.</p>
  </li>
</ul>

<p><br /></p>

<p><br /></p>

<h2 id="3spring-security--custom-login-form">3.Spring Security – Custom Login Form</h2>

<p>By default, the Spring Security framework provides its own login page the get
user credentials but also allows us to set our own custom login page.</p>

<p>It is useful when we want to render a login page that matches the company
website theme. We will do it by creating a <strong>login.jsp</strong>. It will submit to the
<strong>“/authenticateTheUser”</strong> action and then Spring Security will perform
authentication based on the provided input.</p>

<p><strong>EmployeeController.java</strong> – add <strong>/login</strong> to display login page</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@GetMapping</span><span class="o">(</span><span class="s">"/login"</span><span class="o">)</span>
<span class="kd">public</span> <span class="nc">String</span> <span class="nf">login</span><span class="o">()</span> <span class="o">{</span>
	<span class="k">return</span> <span class="s">"login"</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">SecurityConfig.java</code><br />
We used HttpSecurity class to configure the login page. The loginPage() is used
to specify our <strong>login.jsp</strong> page. We can also use any other name for login form
such as login-form.jsp or user-login.jsp and then specify the mapping to this
method. The <strong>“/login”</strong> value passed here will map to the controller’s action
and then render the JSP page.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Override</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">configure</span><span class="o">(</span><span class="nc">HttpSecurity</span> <span class="n">http</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
	<span class="n">http</span><span class="o">.</span><span class="na">authorizeRequests</span><span class="o">().</span><span class="na">anyRequest</span><span class="o">().</span>
	<span class="n">authenticated</span><span class="o">().</span><span class="na">and</span><span class="o">()</span>
	<span class="o">.</span><span class="na">formLogin</span><span class="o">()</span>
	<span class="o">.</span><span class="na">loginPage</span><span class="o">(</span><span class="s">"/login"</span><span class="o">)</span>
	<span class="o">.</span><span class="na">loginProcessingUrl</span><span class="o">(</span><span class="s">"/authenticateTheUser"</span><span class="o">).</span><span class="na">permitAll</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></div></div>

<p>Now It will display our own custom form.
<img src="media/fd9d9a735aafbc6b930c1f81870af0af.png" alt="" /></p>

<p><br /></p>

<h3 id="custom-error-message">Custom Error message</h3>

<p>If the user enters the wrong credentials then Spring Security responds by
attaching an <strong>error</strong> parameter to the URL.Update <strong>login.jsp</strong> page</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&lt;%</span><span class="err">@</span> <span class="n">taglib</span> <span class="n">uri</span><span class="o">=</span><span class="s">"http://java.sun.com/jsp/jstl/core"</span> <span class="n">prefix</span><span class="o">=</span><span class="s">"c"</span><span class="o">%&gt;</span>

<span class="o">&lt;</span><span class="nl">c:</span><span class="k">if</span> <span class="n">test</span><span class="o">=</span><span class="s">"${param.error!=null}"</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">p</span> <span class="n">style</span><span class="o">=</span><span class="s">"color: red"</span><span class="o">&gt;</span><span class="nc">You</span> <span class="n">entered</span> <span class="n">wrong</span> <span class="n">credentials</span><span class="o">!&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="nl">c:</span><span class="k">if</span><span class="o">&gt;</span>
</code></pre></div></div>

<p><br /></p>

<h3 id="logout-user">Logout User</h3>

<p>To implement this feature, follow these steps</p>

<ol>
  <li>
    <p>Add a Logout Button</p>
  </li>
  <li>
    <p>Configure Security</p>
  </li>
  <li>
    <p>Show Message</p>
  </li>
</ol>

<p><strong>1. Add a Logout Button(index.jsp)</strong><br />
add a button to the JSP page that enables logout to the user. This button is a
submit button that submits a form request to the logout URL that will be handle
by Spring Security. Put it on the JSP home page.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&lt;</span><span class="nl">form:</span><span class="n">form</span>
	<span class="n">action</span><span class="o">=</span><span class="s">"${pageContext.request.contextPath}/logout"</span>
	<span class="n">method</span><span class="o">=</span><span class="s">"post"</span><span class="o">&gt;</span>
	<span class="o">&lt;</span><span class="n">input</span> <span class="n">type</span><span class="o">=</span><span class="s">"submit"</span> <span class="n">value</span><span class="o">=</span><span class="s">"logout"</span> <span class="kd">class</span><span class="err">="</span><span class="nc">list</span><span class="o">-</span><span class="n">group</span><span class="o">-</span><span class="n">item</span> <span class="n">list</span><span class="o">-</span><span class="n">group</span><span class="o">-</span><span class="n">item</span><span class="o">-</span><span class="n">action</span><span class="err">"</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="nl">form:</span><span class="n">form</span><span class="o">&gt;</span>
</code></pre></div></div>

<p><strong>2. Configure Security(SecurityConfig.java)</strong><br />
Now, update the <strong>SecurityConfig.java</strong> class by adding <strong>logout()</strong> and
<strong>permitAll()</strong> method.</p>

<ul>
  <li>
    <p><strong>logout()</strong> method will logout the user</p>
  </li>
  <li>
    <p><strong>permitAll()</strong> method give access to all the users to use the logout
feature.</p>
  </li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">.</span><span class="na">logout</span><span class="o">().</span><span class="na">permitAll</span><span class="o">();</span>
</code></pre></div></div>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Override</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">configure</span><span class="o">(</span><span class="nc">HttpSecurity</span> <span class="n">http</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
	<span class="c1">// 2.Custom Login Form</span>
	<span class="n">http</span><span class="o">.</span><span class="na">authorizeRequests</span><span class="o">().</span><span class="na">anyRequest</span><span class="o">()</span>
	<span class="o">.</span><span class="na">authenticated</span><span class="o">()</span>
	<span class="o">.</span><span class="na">and</span><span class="o">()</span>
	<span class="o">.</span><span class="na">formLogin</span><span class="o">()</span>
	<span class="o">.</span><span class="na">loginPage</span><span class="o">(</span><span class="s">"/login"</span><span class="o">)</span>
	<span class="o">.</span><span class="na">loginProcessingUrl</span><span class="o">(</span><span class="s">"/authenticateTheUser"</span><span class="o">)</span>
	<span class="o">.</span><span class="na">permitAll</span><span class="o">()</span>
	<span class="o">.</span><span class="na">and</span><span class="o">()</span>
	<span class="o">.</span><span class="na">logout</span><span class="o">()</span>
	<span class="o">.</span><span class="na">permitAll</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></div></div>

<p><strong>3.Show Message(login.jsp)</strong><br />
Now, set a message to show the user when the user logged out successfully. Add
it to the <strong>login.jsp</strong> to display a logout message to the user after successful
logout.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&lt;</span><span class="nl">c:</span><span class="k">if</span> <span class="n">test</span><span class="o">=</span><span class="s">"${param.logout!=null}"</span><span class="o">&gt;</span>
	<span class="o">&lt;</span><span class="n">p</span> <span class="n">style</span><span class="o">=</span><span class="s">"color: green"</span><span class="o">&gt;</span><span class="nc">You</span> <span class="n">have</span> <span class="n">successfully</span> <span class="n">logged</span> <span class="n">out</span><span class="o">.!&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="nl">c:</span><span class="k">if</span><span class="o">&gt;</span>
</code></pre></div></div>

<p><img src="media/ecb037baf4f051560ad538b81c55f77a.png" alt="" /></p>

<p><br /></p>

<h3 id="remember-me-feature">Remember Me Feature</h3>

<p><strong>remember-me</strong> feature of Spring Security allows a user to remember even after
the session is closed. It performs automatic login by using the stored
<strong>cookies</strong>.</p>

<p>An application that has a remember-me feature, stores a cookie in the browser
which is used to identify the user and avoid entering the user credentials each
time to log in. So what we need to do is just simply use the <strong>rememberMe()</strong>
method in the <strong>configure()</strong> method of SecurityConfig class.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Override</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">configure</span><span class="o">(</span><span class="nc">HttpSecurity</span> <span class="n">http</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
	<span class="c1">// 2.Custom Login Form</span>
	<span class="n">http</span><span class="o">.</span><span class="na">authorizeRequests</span><span class="o">().</span><span class="na">anyRequest</span><span class="o">()</span>
	<span class="o">.</span><span class="na">authenticated</span><span class="o">()</span>
	<span class="o">.</span><span class="na">and</span><span class="o">()</span>
	<span class="o">.</span><span class="na">formLogin</span><span class="o">().</span><span class="na">loginPage</span><span class="o">(</span><span class="s">"/login"</span><span class="o">).</span><span class="na">loginProcessingUrl</span><span class="o">(</span><span class="s">"/authenticateTheUser"</span><span class="o">)</span>
	<span class="o">.</span><span class="na">permitAll</span><span class="o">()</span>
	<span class="o">.</span><span class="na">and</span><span class="o">()</span>
	<span class="o">.</span><span class="na">logout</span><span class="o">().</span><span class="na">permitAll</span><span class="o">()</span>
	<span class="o">.</span><span class="na">and</span><span class="o">()</span>
<span class="o">.</span><span class="na">rememberMe</span><span class="o">().</span><span class="na">key</span><span class="o">(</span><span class="s">"rem-me-key"</span><span class="o">)</span>  
		   <span class="o">.</span><span class="na">rememberMeParameter</span><span class="o">(</span><span class="s">"remember"</span><span class="o">)</span>  
		   <span class="o">.</span><span class="na">rememberMeCookieName</span><span class="o">(</span><span class="s">"rememberlogin"</span><span class="o">)</span>  
		   <span class="o">.</span><span class="na">tokenValiditySeconds</span><span class="o">(</span><span class="mi">200</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>

<p><img src="media/79e37ba405afebf2de85f0fd6bea3322.png" alt="" /></p>

<p><strong>Verify the Cookies</strong><br />
See it stores the cookie that we set in the SecurityConfig file. It has the same
name that we set and a token in encrypted form and expiring life of the cookie.</p>

<p><img src="media/87199cb82d73f0993d142b39829372b9.png" alt="" /></p>

<p><br /></p>

<h2 id="4spring-security--jdbc-authentication">4.Spring Security – JDBC Authentication</h2>

<p>By default, spring security expects tables named <strong>users</strong> table for storing
username, passwords and <strong>authorities</strong> table for storing the associated roles.</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">CREATE</span> <span class="k">TABLE</span> <span class="nv">`users`</span> <span class="p">(</span>
  <span class="nv">`username`</span> <span class="nb">varchar</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">,</span>
  <span class="nv">`password`</span> <span class="nb">varchar</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">,</span>
  <span class="nv">`enabled`</span> <span class="nb">tinyint</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">,</span>
  <span class="k">PRIMARY</span> <span class="k">KEY</span> <span class="p">(</span><span class="nv">`username`</span><span class="p">)</span>
<span class="p">)</span> <span class="n">ENGINE</span><span class="o">=</span><span class="n">InnoDB</span> <span class="k">DEFAULT</span> <span class="n">CHARSET</span><span class="o">=</span><span class="n">latin1</span><span class="p">;</span>

<span class="k">INSERT</span> <span class="k">INTO</span> <span class="nv">`users`</span> 
<span class="k">VALUES</span> 
<span class="p">(</span><span class="s1">'satya'</span><span class="p">,</span><span class="s1">'{noop}satya'</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span>
<span class="p">(</span><span class="s1">'a'</span><span class="p">,</span><span class="s1">'{noop}a'</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>


<span class="k">CREATE</span> <span class="k">TABLE</span> <span class="nv">`authorities`</span> <span class="p">(</span>
  <span class="nv">`username`</span> <span class="nb">varchar</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">,</span>
  <span class="nv">`authority`</span> <span class="nb">varchar</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">,</span>
  <span class="k">UNIQUE</span> <span class="k">KEY</span> <span class="nv">`authorities_idx_1`</span> <span class="p">(</span><span class="nv">`username`</span><span class="p">,</span><span class="nv">`authority`</span><span class="p">),</span>
  <span class="k">CONSTRAINT</span> <span class="nv">`authorities_ibfk_1`</span> <span class="k">FOREIGN</span> <span class="k">KEY</span> <span class="p">(</span><span class="nv">`username`</span><span class="p">)</span> <span class="k">REFERENCES</span> <span class="nv">`users`</span> <span class="p">(</span><span class="nv">`username`</span><span class="p">)</span>
<span class="p">)</span> <span class="n">ENGINE</span><span class="o">=</span><span class="n">InnoDB</span> <span class="k">DEFAULT</span> <span class="n">CHARSET</span><span class="o">=</span><span class="n">latin1</span><span class="p">;</span>

<span class="k">INSERT</span> <span class="k">INTO</span> <span class="nv">`authorities`</span> 
<span class="k">VALUES</span> 
<span class="p">(</span><span class="s1">'satya'</span><span class="p">,</span><span class="s1">'ROLE_ADMIN'</span><span class="p">),</span>
<span class="p">(</span><span class="s1">'a'</span><span class="p">,</span> <span class="s1">'ROLE_GUEST'</span><span class="p">)</span>
</code></pre></div></div>

<p>Override <strong>configure(AuthenticationManagerBuilder)</strong> — this method will help us
in fetching user data from DB and validate if the credentials provided by the
user is valid</p>

<p><code class="language-plaintext highlighter-rouge">SecurityConfig.java</code></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="nn">springboot.security</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.sql.DataSource</span><span class="o">;</span>

<span class="nd">@Configuration</span>
<span class="nd">@EnableWebSecurity</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SecurityConfig</span> <span class="kd">extends</span> <span class="nc">WebSecurityConfigurerAdapter</span> <span class="o">{</span>

    <span class="nd">@Autowired</span>
    <span class="nc">DataSource</span> <span class="n">dataSource</span><span class="o">;</span>
		
    <span class="c1">//Enable jdbc authentication</span>
    <span class="nd">@Autowired</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">configAuthentication</span><span class="o">(</span><span class="nc">AuthenticationManagerBuilder</span> <span class="n">auth</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">auth</span><span class="o">.</span><span class="na">jdbcAuthentication</span><span class="o">().</span><span class="na">dataSource</span><span class="o">(</span><span class="n">dataSource</span><span class="o">);</span>
    <span class="o">}</span>
		
	<span class="nd">@Override</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">configure</span><span class="o">(</span><span class="nc">HttpSecurity</span> <span class="n">http</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>

		<span class="c1">//3. JDBC Authenication</span>
		<span class="c1">//role should not start with 'ROLE_' since it is automatically inserted</span>
		<span class="c1">// ADMIN - Allowed All Operations - ADD, EDIT , DELETE</span>
		<span class="c1">// GUEST- Allowed VIEW Operations - VIEW, SHOW</span>
		<span class="n">http</span><span class="o">.</span><span class="na">authorizeRequests</span><span class="o">()</span>
		<span class="o">.</span><span class="na">antMatchers</span><span class="o">(</span><span class="s">"/"</span><span class="o">).</span><span class="na">hasAnyRole</span><span class="o">(</span><span class="s">"GUEST"</span><span class="o">,</span><span class="s">"ADMIN"</span><span class="o">)</span>
		<span class="o">.</span><span class="na">antMatchers</span><span class="o">(</span><span class="s">"/all"</span><span class="o">).</span><span class="na">hasAnyRole</span><span class="o">(</span><span class="s">"GUEST"</span><span class="o">,</span><span class="s">"ADMIN"</span><span class="o">)</span>
		<span class="o">.</span><span class="na">antMatchers</span><span class="o">(</span><span class="s">"/addEmployee"</span><span class="o">).</span><span class="na">hasRole</span><span class="o">(</span><span class="s">"ADMIN"</span><span class="o">)</span>
		<span class="o">.</span><span class="na">antMatchers</span><span class="o">(</span><span class="s">"/saveEmployee"</span><span class="o">).</span><span class="na">hasRole</span><span class="o">(</span><span class="s">"ADMIN"</span><span class="o">)</span>
		<span class="o">.</span><span class="na">antMatchers</span><span class="o">(</span><span class="s">"/deleteEmployee"</span><span class="o">).</span><span class="na">hasRole</span><span class="o">(</span><span class="s">"ADMIN"</span><span class="o">)</span>
		<span class="o">.</span><span class="na">and</span><span class="o">()</span>
		<span class="o">.</span><span class="na">formLogin</span><span class="o">()</span>
		<span class="o">.</span><span class="na">loginPage</span><span class="o">(</span><span class="s">"/login"</span><span class="o">)</span>
		<span class="o">.</span><span class="na">loginProcessingUrl</span><span class="o">(</span><span class="s">"/authenticateTheUser"</span><span class="o">)</span>
		<span class="o">.</span><span class="na">permitAll</span><span class="o">()</span>
		<span class="o">.</span><span class="na">and</span><span class="o">()</span>
		<span class="o">.</span><span class="na">logout</span><span class="o">()</span>
		<span class="o">.</span><span class="na">permitAll</span><span class="o">()</span>
		<span class="o">.</span><span class="na">and</span><span class="o">()</span>
		<span class="o">.</span><span class="na">exceptionHandling</span><span class="o">().</span><span class="na">accessDeniedPage</span><span class="o">(</span><span class="s">"/unauthorized"</span><span class="o">);</span>		
	<span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p><br /></p>

<h2 id="5-spring-security--ldap-authentication">5. Spring Security – LDAP Authentication</h2>

<h3 id="what-is-ldap">What is LDAP?</h3>

<p>LDAP is Lightweight Directory Access Protocol that is used to interact with
directory server. LDAP is a centralized directory acts as a data source, which
contains all important information related to the organization such as user
details, system information, etc. LDAP is used for authentication and storing
information about users, groups and applications.</p>

<p>Spring Security provides LdapAuthenticationProvider class to authenticate a user
against a LDAP server. The equivalent XML element is
&lt;ldap-authentication-provider&gt;.<br />
LDAP node is created with following keywords.</p>

<ul>
  <li>
    <p><strong>uid</strong> : User Id</p>
  </li>
  <li>
    <p><strong>cn</strong> : Common Name</p>
  </li>
  <li>
    <p><strong>sn</strong> : Surname</p>
  </li>
  <li>
    <p><strong>o</strong> : Organization</p>
  </li>
  <li>
    <p><strong>ou</strong> : Organizational unit</p>
  </li>
  <li>
    <p><strong>dn</strong> : Distinguished name</p>
  </li>
  <li>
    <p><strong>dc</strong> : Domain Component</p>
  </li>
</ul>

<p>When the user submits login form, then to find the user a LDAP DN is created.
Suppose the username is <strong>‘krishna</strong>’ then the actual name used to authenticate
to LDAP will be the full DN as following.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">uid</span><span class="o">=</span><span class="n">krishna</span><span class="o">,</span><span class="n">ou</span><span class="o">=</span><span class="n">people</span><span class="o">,</span><span class="n">dc</span><span class="o">=</span><span class="n">concretepage</span><span class="o">,</span><span class="n">dc</span><span class="o">=</span><span class="n">com</span>
</code></pre></div></div>

<h3 id="ldap-server-configuration-free-online">LDAP Server Configuration (Free Online)</h3>

<p><strong>LDAP Server Information (read-only access):</strong></p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nl">Server:</span> <span class="n">ldap</span><span class="o">.</span><span class="na">forumsys</span><span class="o">.</span><span class="na">com</span>   
<span class="nl">Port:</span> <span class="mi">389</span>

<span class="nc">Bind</span> <span class="nl">DN:</span> <span class="n">cn</span><span class="o">=</span><span class="n">read</span><span class="o">-</span><span class="n">only</span><span class="o">-</span><span class="n">admin</span><span class="o">,</span><span class="n">dc</span><span class="o">=</span><span class="n">example</span><span class="o">,</span><span class="n">dc</span><span class="o">=</span><span class="n">com</span>  
<span class="nc">Bind</span> <span class="nl">Password:</span> <span class="n">password</span>
</code></pre></div></div>

<p>All user passwords are <em>password</em>.</p>

<p>Ref.
<a href="https://www.forumsys.com/tutorials/integration-how-to/ldap/online-ldap-test-server/">https://www.forumsys.com/tutorials/integration-how-to/ldap/online-ldap-test-server/</a></p>

<p><img src="media/635130ddb1dcc576e63b6544b502a689.png" alt="" /></p>

<p><img src="media/ef3a31758a2a8480beb4d3e19608d18c.png" alt="" /></p>

<p><img src="media/c3acd19f92e3004edd96093471d30789.png" alt="" /></p>

<p><img src="media/2bcd975f43c8c469d1c65ceb113b367a.png" alt="" /></p>

<p><img src="media/24b3482f6deb5a7a34abce92f794ee91.png" alt="" /></p>

<h3 id="example-code">Example Code</h3>

<p><strong>Pom.xml</strong> – Update Maven Dependency</p>
<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;dependency&gt;</span>
   <span class="nt">&lt;groupId&gt;</span>org.springframework.security<span class="nt">&lt;/groupId&gt;</span>
   <span class="nt">&lt;artifactId&gt;</span>spring-security-ldap<span class="nt">&lt;/artifactId&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>

<span class="nt">&lt;dependency&gt;</span>
   <span class="nt">&lt;groupId&gt;</span>org.apache.directory.server<span class="nt">&lt;/groupId&gt;</span>
   <span class="nt">&lt;artifactId&gt;</span>apacheds-server-jndi<span class="nt">&lt;/artifactId&gt;</span>
   <span class="nt">&lt;version&gt;</span>1.5.5<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
</code></pre></div></div>

<p><strong>application.properties</strong> – update LDAP Server Properties</p>
<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ldap.urls=ldap://ldap.forumsys.com:389/
ldap.base.dn=dc=example,dc=com
ldap.username=cn=read-only-admin,dc=example,dc=com
ldap.password=password
ldap.user.dn.pattern = uid={0}
</code></pre></div></div>

<p><strong>SpringSecurityConfig</strong></p>

<p>At this point, we need to tell spring how to we are doing authentication, as in
which URLs should be authenticated. We need to update Authentication provider as
LDAP in our code.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Configuration</span>
<span class="nd">@EnableWebSecurity</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">LDAPAuthenticationSecurityConfig</span> <span class="kd">extends</span> <span class="nc">WebSecurityConfigurerAdapter</span> <span class="o">{</span> 
	
    <span class="nd">@Value</span><span class="o">(</span><span class="s">"${ldap.urls}"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">ldapUrls</span><span class="o">;</span>	

    <span class="nd">@Value</span><span class="o">(</span><span class="s">"${ldap.base.dn}"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">ldapBaseDn</span><span class="o">;</span>

    <span class="nd">@Value</span><span class="o">(</span><span class="s">"${ldap.username}"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">ldapSecurityPrincipal</span><span class="o">;</span>

    <span class="nd">@Value</span><span class="o">(</span><span class="s">"${ldap.password}"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">ldapPrincipalPassword</span><span class="o">;</span>

    <span class="nd">@Value</span><span class="o">(</span><span class="s">"${ldap.user.dn.pattern}"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">ldapUserDnPattern</span><span class="o">;</span>
    
 
    <span class="nd">@Override</span>
    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">configure</span><span class="o">(</span><span class="nc">AuthenticationManagerBuilder</span> <span class="n">auth</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
        	<span class="n">auth</span><span class="o">.</span><span class="na">ldapAuthentication</span><span class="o">()</span>
                <span class="o">.</span><span class="na">contextSource</span><span class="o">()</span>
                <span class="o">.</span><span class="na">url</span><span class="o">(</span><span class="n">ldapUrls</span> <span class="o">+</span> <span class="n">ldapBaseDn</span><span class="o">)</span>
                <span class="o">.</span><span class="na">managerDn</span><span class="o">(</span><span class="n">ldapSecurityPrincipal</span><span class="o">)</span>
                <span class="o">.</span><span class="na">managerPassword</span><span class="o">(</span><span class="n">ldapPrincipalPassword</span><span class="o">)</span>
                <span class="o">.</span><span class="na">and</span><span class="o">()</span>
                <span class="o">.</span><span class="na">userDnPatterns</span><span class="o">(</span><span class="n">ldapUserDnPattern</span><span class="o">);</span>
    <span class="o">}</span>
	
    
	<span class="c1">//4. LDAP Authenication</span>
	<span class="c1">//role should not start with 'ROLE_' since it is automatically inserted</span>
	<span class="c1">// authenticated - Allowed All Operations - ADD, EDIT , DELETE</span>
	<span class="c1">// permitAll- Allowed VIEW Operations - VIEW, SHOW</span>
    
    <span class="nd">@Override</span>
    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">configure</span><span class="o">(</span><span class="nc">HttpSecurity</span> <span class="n">http</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
    		<span class="n">http</span><span class="o">.</span><span class="na">authorizeRequests</span><span class="o">()</span>
                <span class="o">.</span><span class="na">antMatchers</span><span class="o">(</span><span class="s">"/login**"</span><span class="o">).</span><span class="na">anonymous</span><span class="o">()</span>
                <span class="o">.</span><span class="na">antMatchers</span><span class="o">(</span><span class="s">"/all"</span><span class="o">).</span><span class="na">permitAll</span><span class="o">()</span>
                <span class="o">.</span><span class="na">antMatchers</span><span class="o">(</span><span class="s">"/view**"</span><span class="o">).</span><span class="na">permitAll</span><span class="o">()</span>
                <span class="o">.</span><span class="na">antMatchers</span><span class="o">(</span><span class="s">"/addEmployee"</span><span class="o">).</span><span class="na">authenticated</span><span class="o">()</span>
                <span class="o">.</span><span class="na">antMatchers</span><span class="o">(</span><span class="s">"/addEmployee"</span><span class="o">).</span><span class="na">authenticated</span><span class="o">()</span>
                <span class="o">.</span><span class="na">antMatchers</span><span class="o">(</span><span class="s">"/deleteEmployee"</span><span class="o">).</span><span class="na">authenticated</span><span class="o">()</span>
                <span class="o">.</span><span class="na">and</span><span class="o">()</span>
                <span class="o">.</span><span class="na">formLogin</span><span class="o">()</span>
                <span class="o">.</span><span class="na">loginPage</span><span class="o">(</span><span class="s">"/login"</span><span class="o">)</span>
                <span class="o">.</span><span class="na">loginProcessingUrl</span><span class="o">(</span><span class="s">"/authenticateTheUser"</span><span class="o">)</span>
                <span class="o">.</span><span class="na">permitAll</span><span class="o">()</span>
                <span class="o">.</span><span class="na">and</span><span class="o">()</span>
                <span class="o">.</span><span class="na">logout</span><span class="o">()</span>
                <span class="o">.</span><span class="na">permitAll</span><span class="o">()</span>
                <span class="o">.</span><span class="na">and</span><span class="o">()</span>
                <span class="o">.</span><span class="na">csrf</span><span class="o">()</span>
                <span class="o">.</span><span class="na">disable</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>For Testing</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//All UID’s password is: **password**</span>
<span class="n">uid</span><span class="o">=</span><span class="n">boyle</span>
<span class="n">uid</span><span class="o">=</span><span class="n">curie</span>
<span class="n">uid</span><span class="o">=</span><span class="n">einstein</span>
<span class="n">uid</span><span class="o">=</span><span class="n">euclid</span>
<span class="n">uid</span><span class="o">=</span><span class="n">euler</span>
</code></pre></div></div>

<p><img src="media/7c31fff1299bb7a1654b8b612cab5292.png" alt="" /></p>

<p>We can access /all , /view** - with out login. But for /addEmployee,
/saveEmployee user must login with LDAP credencials.</p>

<p><br /></p>

<p><br /></p>

<h2 id="6-spring-security--jwt-authentication">6. Spring Security – JWT Authentication</h2>

<h3 id="what-is-jwt-authentication">What is JWT Authentication</h3>

<p><img src="media/b0300063140e7bd8027398de1e810868.png" alt="" /></p>

<p>By using JWT authentication you no longer have to store user information in a
session to authenticate each request. Instead, we send this information with
each request along with any data we want.</p>

<p>When the client logs in, the server gives them a JSON Web Token (JWT).
Afterward, the client has to put that token in the Authorization header of each
request after the word <em>Bearer</em> and space.</p>

<p>The token has three different <strong>parts, the header, the payload, and the
signature</strong>.</p>

<p><img src="media/755bfcc9811d8a964c741f27690147ed.jpeg" alt="JWT Structure" /></p>

<p><br /></p>

<p><strong>Create JWT Token Online</strong></p>

<p>Will generate JWT Token by using <a href="http://jwtbuilder.jamiekurtz.com/">JWT Online Token
Generator</a>.Provide the payload as given
below:<img src="media/d3cf349a2264c0d279cc8b0e0595d5d0.jpeg" alt="Standard JWT Claims" />Provide
Claim data.<img src="media/b354ef5ac00aca719de6981a7a0523c7.jpeg" alt="Additional
Claims" />We’ll have the following
claims in the payload.<img src="media/d92551d2e9a0c00bb2206c684151f10b.jpeg" alt="Generated Claim
Set" />Sign the payload using the
hashing algorithm.<img src="media/837ab8caf99e06838ef17ad1f15755e4.jpeg" alt="Signed JSON Web
Token" /></p>

<p><img src="media/bc8632f867c2ea823fdda046f0386050.jpeg" alt="" /></p>

<p><br /></p>

<h3 id="example">Example</h3>

<p>Pom.xml</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&lt;</span><span class="n">dependency</span><span class="o">&gt;</span>
   <span class="o">&lt;</span><span class="n">groupId</span><span class="o">&gt;</span><span class="n">io</span><span class="o">.</span><span class="na">jsonwebtoken</span><span class="o">&lt;/</span><span class="n">groupId</span><span class="o">&gt;</span>
   <span class="o">&lt;</span><span class="n">artifactId</span><span class="o">&gt;</span><span class="n">jjwt</span><span class="o">&lt;/</span><span class="n">artifactId</span><span class="o">&gt;</span>
   <span class="o">&lt;</span><span class="n">version</span><span class="o">&gt;</span><span class="mf">0.9</span><span class="o">.</span><span class="mi">1</span><span class="o">&lt;/</span><span class="n">version</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">dependency</span><span class="o">&gt;</span>
</code></pre></div></div>

<p>We have API for Employee Services</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">/</span> 	 	<span class="no">GET</span> 	 <span class="nc">Homepage</span>
<span class="o">/</span><span class="n">login</span> 	 	<span class="no">GET</span> 	 <span class="nc">Loginform</span>
<span class="o">/</span><span class="n">all</span> 	 	<span class="no">GET</span> 	 <span class="nc">All</span> <span class="nc">Employees</span> 
<span class="o">/</span><span class="n">saveEmployee</span> 	<span class="no">POST</span> 	 <span class="n">saveEmployee</span>

</code></pre></div></div>

<p>Not much Important for now, Skipping</p>

<p>Ref.
<a href="https://www.tutorialspoint.com/spring_security/spring_security_with_jwt.htm">https://www.tutorialspoint.com/spring_security/spring_security_with_jwt.htm</a></p>

<p><br /></p>

<h2 id="7-spring-security--oauth-20-sso-authentication">7. Spring Security – OAuth 2.0 SSO Authentication</h2>

<p>Spring Boot 2.x provides full auto-configuration for OAuth2 login. We just need
to configure client id and client secret for OAuth2 provider such as GitHub,
Facebook and Google in <strong>application.property</strong> file and we are done.</p>

<p>We can customize the configuration by overriding methods of
WebSecurityConfigurerAdapter and using HttpSecurity.oauth2Login() method
introduced in Spring 5.0.</p>

<p>We need to create a bean for ClientRegistrationRepository to override OAuth2
property value.<br />
Here on this page we will create a Spring Boot Security application for OAuth2
login using GitHub, Facebook and Google authentication provider.</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;dependency&gt;</span>
	<span class="nt">&lt;groupId&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>
	<span class="nt">&lt;artifactId&gt;</span>spring-boot-starter-oauth2-client<span class="nt">&lt;/artifactId&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
</code></pre></div></div>

<h3 id="example-1">Example</h3>

<p>1.Genetrate github API Keys by going <a href="https://github.com/settings/developers">https://github.com/settings/developers</a></p>

<p><img src="media/57fb84d2a78b5d1ef97f2df5ae403d32.png" alt="" /></p>

<p>redirect URI as</p>
<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>http://localhost:8080/login/oauth2/code/github
http://localhost:8081/login/oauth2/code/google
http://localhost:8081/login/oauth2/code/facebook
</code></pre></div></div>

<p>Watch this : <a href="https://www.youtube.com/watch?v=R9lxXQcy-nM">https://www.youtube.com/watch?v=R9lxXQcy-nM</a></p>

<p><img src="media/ca12778952ba93937102afc5d33b7127.png" alt="" /></p>

<p><br /></p>

<p>2.Update <strong>application.properties</strong></p>
<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>spring.security.oauth2.client.registration.google.client-id=\<span class="nt">&lt;your</span> <span class="err">client</span> <span class="err">id\</span><span class="nt">&gt;</span>
spring.security.oauth2.client.registration.google.client-secret=\<span class="nt">&lt;your</span> <span class="err">client</span>
<span class="err">secret\</span><span class="nt">&gt;</span>

spring.security.oauth2.client.registration.facebook.client-id=\<span class="nt">&lt;your</span> <span class="err">client</span> <span class="err">id\</span><span class="nt">&gt;</span>
spring.security.oauth2.client.registration.facebook.client-secret=\<span class="nt">&lt;your</span> <span class="err">client</span>
<span class="err">secret\</span><span class="nt">&gt;</span>

spring.security.oauth2.client.registration.github.client-id=4d381Dummy
spring.security.oauth2.client.registration.github.client-secret=2876951aSercrit
</code></pre></div></div>

<p><br /></p>

<ol>
  <li>Update Login Page</li>
</ol>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">" /oauth2/authorization/github"</span><span class="nt">&gt;</span>Login with GitHub<span class="nt">&lt;/a&gt;</span>
</code></pre></div></div>

<p><br /></p>

<p><code class="language-plaintext highlighter-rouge">4.CustomOAuth2User.java</code></p>

<p>this class extends OAuthUser interface as defined by Spring OAuth2 API. this
class wraps an instance of <strong>OAuth2User</strong>, which will be passed by Spring OAuth2
upon successful OAuth authentication. And we override the <strong>getName()</strong> method
to return <strong>username</strong> associated with GitHub account.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">CustomOAuth2User</span> <span class="kd">implements</span> <span class="nc">OAuth2User</span> <span class="o">{</span>
	<span class="kd">private</span> <span class="nc">OAuth2User</span> <span class="n">oauth2User</span><span class="o">;</span>
	
	<span class="kd">public</span> <span class="nf">CustomOAuth2User</span><span class="o">(</span><span class="nc">OAuth2User</span> <span class="n">oauth2User</span><span class="o">)</span> <span class="o">{</span>
		<span class="k">this</span><span class="o">.</span><span class="na">oauth2User</span> <span class="o">=</span> <span class="n">oauth2User</span><span class="o">;</span>
	<span class="o">}</span>
	<span class="nd">@Override</span>
	<span class="kd">public</span> <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Object</span><span class="o">&gt;</span> <span class="nf">getAttributes</span><span class="o">()</span> <span class="o">{</span>
		<span class="k">return</span> <span class="n">oauth2User</span><span class="o">.</span><span class="na">getAttributes</span><span class="o">();</span>
	<span class="o">}</span>
	<span class="nd">@Override</span>
	<span class="kd">public</span> <span class="nc">Collection</span><span class="o">&lt;?</span> <span class="kd">extends</span> <span class="nc">GrantedAuthority</span><span class="o">&gt;</span> <span class="nf">getAuthorities</span><span class="o">()</span> <span class="o">{</span>
		<span class="k">return</span> <span class="n">oauth2User</span><span class="o">.</span><span class="na">getAuthorities</span><span class="o">();</span>
	<span class="o">}</span>
	<span class="nd">@Override</span>
	<span class="kd">public</span> <span class="nc">String</span> <span class="nf">getName</span><span class="o">()</span> <span class="o">{</span>
		<span class="k">return</span> <span class="n">oauth2User</span><span class="o">.</span><span class="na">getAttribute</span><span class="o">(</span><span class="s">"name"</span><span class="o">);</span>
	<span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p><br /></p>

<p>5.CustomOAuth2UserService subclass of DefaultOAuth2UserService. we override
the loadUser() method which will be called by Spring OAuth2 upon successful
authentication, and it returns a new CustomOAuth2User object</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Service</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">CustomOAuth2UserService</span> <span class="kd">extends</span> <span class="nc">DefaultOAuth2UserService</span>  <span class="o">{</span>

	<span class="nd">@Override</span>
	<span class="kd">public</span> <span class="nc">OAuth2User</span> <span class="nf">loadUser</span><span class="o">(</span><span class="nc">OAuth2UserRequest</span> <span class="n">userRequest</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">OAuth2AuthenticationException</span> <span class="o">{</span>
		<span class="nc">OAuth2User</span> <span class="n">user</span> <span class="o">=</span>  <span class="kd">super</span><span class="o">.</span><span class="na">loadUser</span><span class="o">(</span><span class="n">userRequest</span><span class="o">);</span>
		<span class="k">return</span> <span class="k">new</span> <span class="nf">CustomOAuth2User</span><span class="o">(</span><span class="n">user</span><span class="o">);</span>
	<span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p><br /></p>

<p>6.OAuth2AuthenticationSecurityConfig To integrate single sign on with GitHub
with traditional username and password login, update configuration for Spring
security as follows</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Configuration</span>
<span class="nd">@EnableWebSecurity</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">OAuth2AuthenticationSecurityConfig</span> <span class="kd">extends</span> <span class="nc">WebSecurityConfigurerAdapter</span> <span class="o">{</span>
	
	<span class="nd">@Autowired</span>
	<span class="kd">private</span> <span class="nc">CustomOAuth2UserService</span> <span class="n">userService</span><span class="o">;</span>

	<span class="nd">@Override</span>
	<span class="kd">protected</span> <span class="kt">void</span> <span class="nf">configure</span><span class="o">(</span><span class="nc">HttpSecurity</span> <span class="n">http</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
		<span class="n">http</span><span class="o">.</span><span class="na">authorizeRequests</span><span class="o">().</span><span class="na">antMatchers</span><span class="o">(</span><span class="s">"/"</span><span class="o">,</span> <span class="s">"/login"</span><span class="o">).</span><span class="na">permitAll</span><span class="o">()</span>
		<span class="o">.</span><span class="na">and</span><span class="o">()</span>
		<span class="o">.</span><span class="na">formLogin</span><span class="o">()</span>
		<span class="o">.</span><span class="na">loginPage</span><span class="o">(</span><span class="s">"/login"</span><span class="o">)</span>
		<span class="o">.</span><span class="na">loginProcessingUrl</span><span class="o">(</span><span class="s">"/authenticateTheUser"</span><span class="o">)</span>
		<span class="o">.</span><span class="na">permitAll</span><span class="o">()</span>
		<span class="o">.</span><span class="na">and</span><span class="o">()</span>
		<span class="o">.</span><span class="na">logout</span><span class="o">()</span>
		<span class="o">.</span><span class="na">permitAll</span><span class="o">()</span>
       <span class="o">.</span><span class="na">and</span><span class="o">()</span>
              <span class="o">.</span><span class="na">oauth2Login</span><span class="o">()</span>
              <span class="o">.</span><span class="na">loginPage</span><span class="o">(</span><span class="s">"/login"</span><span class="o">)</span>
              <span class="o">.</span><span class="na">userInfoEndpoint</span><span class="o">()</span>
              <span class="o">.</span><span class="na">userService</span><span class="o">(</span><span class="n">userService</span><span class="o">);</span>
	<span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p><br /></p>

<p>7.Test Login using GitHub</p>

<p><img src="media/8d646cc25f48462b4ae7bd23b5a1b363.png" alt="" /></p>

<p><img src="media/813b3da634f04095e9af9a4bb4ac0086.png" alt="" /></p>

<p><img src="media/054f04b587a95c4723813e1a07f98632.png" alt="" /></p>

<h2 id="8-spring-security--summary">8. Spring Security – Summary</h2>

<p>To customize Spring Security, we need a configuration class annotated with
<strong>@EnableWebSecurity</strong> annotation in our classpath. Also, to simplify the
customization process, the framework exposes a <strong>WebSecurityConfigurerAdapter</strong>
class.</p>

<p>We will extend this adapter and override both of its functions so as to:</p>

<ul>
  <li>
    <p><strong>Configure</strong> the authentication manager with the correct provider</p>
  </li>
  <li>
    <p><strong>Configure</strong> web security (public URLs, private URLs, authorization, etc.)</p>
  </li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@EnableWebSecurity</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SecurityConfig</span> <span class="kd">extends</span> <span class="nc">WebSecurityConfigurerAdapter</span> <span class="o">{</span>

    <span class="nd">@Override</span>
    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">configure</span><span class="o">(</span><span class="nc">AuthenticationManagerBuilder</span> <span class="n">auth</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
        <span class="c1">// TODO configure authentication manager</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">configure</span><span class="o">(</span><span class="nc">HttpSecurity</span> <span class="n">http</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
        <span class="c1">// TODO configure web security</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<h2 id="9spring-security--ref">9.Spring Security – Ref.</h2>

<p><a href="https://www.studytonight.com/spring-framework/spring-security-introduction">https://www.studytonight.com/spring-framework/spring-security-introduction</a></p>

<p><a href="https://www.section.io/engineering-education/an-all-in-one-spring-security-crash-course-for-java-developers/">https://www.section.io/engineering-education/an-all-in-one-spring-security-crash-course-for-java-developers/</a></p>

<p><a href="https://www.concretepage.com/spring-5/spring-security-ldap-authentication">https://www.concretepage.com/spring-5/spring-security-ldap-authentication</a></p>

<p><a href="https://medium.com/codeops/spring-boot-security-ldap-example-1ce1bdfc5816">https://medium.com/codeops/spring-boot-security-ldap-example-1ce1bdfc5816</a></p>

<p><a href="https://www.logicbig.com/tutorials/spring-framework/spring-security.html">https://www.logicbig.com/tutorials/spring-framework/spring-security.html</a></p>

<p><a href="https://examples.javacodegeeks.com/enterprise-java/spring/boot/spring-boot-in-memory-basic-authentication-example/">https://examples.javacodegeeks.com/enterprise-java/spring/boot/spring-boot-in-memory-basic-authentication-example/</a></p>

<p><a href="https://www.techgeeknext.com/spring/spring-boot-security-token-authentication-jwt">https://www.techgeeknext.com/spring/spring-boot-security-token-authentication-jwt</a></p>

<p><a href="https://www.baeldung.com/spring-security-5-oauth2-login">https://www.baeldung.com/spring-security-5-oauth2-login</a></p>

<p><a href="https://www.codejava.net/frameworks/spring-boot/oauth2-login-with-github-example">https://www.codejava.net/frameworks/spring-boot/oauth2-login-with-github-example</a></p>
</div><div class="d-print-none"><footer class="article__footer"><!-- start custom article footer snippet -->

<!-- end custom article footer snippet --></footer><div class="article__section-navigator clearfix"><div class="previous"><span>PREVIOUS</span><a href="/springboot/springboot-advanced">SpringBoot Advanced</a></div><div class="next"><span>NEXT</span><a href="/springboot/springboot-microservices">SpringBoot Microservices</a></div></div></div>

</div>

<script>(function() {
  var SOURCES = window.TEXT_VARIABLES.sources;
  window.Lazyload.js(SOURCES.jquery, function() {
    $(function() {
      var $this ,$scroll;
      var $articleContent = $('.js-article-content');
      var hasSidebar = $('.js-page-root').hasClass('layout--page--sidebar');
      var scroll = hasSidebar ? '.js-page-main' : 'html, body';
      $scroll = $(scroll);

      $articleContent.find('.highlight').each(function() {
        $this = $(this);
        $this.attr('data-lang', $this.find('code').attr('data-lang'));
      });
      $articleContent.find('h1[id], h2[id], h3[id], h4[id], h5[id], h6[id]').each(function() {
        $this = $(this);
        $this.append($('<a class="anchor d-print-none" aria-hidden="true"></a>').html('<i class="fas fa-anchor"></i>'));
      });
      $articleContent.on('click', '.anchor', function() {
        $scroll.scrollToAnchor('#' + $(this).parent().attr('id'), 400);
      });
    });
  });
})();
//alert('start .......');
document.getElementsByClassName('article__header')[0].style.display = 'none';
document.getElementsByClassName('article__info')[0].style.display = 'none';
//alert(' end .......');
 
 document.onreadystatechange = function(){
     if(document.readyState === 'complete'){
         /*code here*/
		 //alert('onreadystatechange comled ... start .......');
document.getElementsByClassName('article__header')[0].style.display = 'none';
document.getElementsByClassName('article__info')[0].style.display = 'none';
//alert('onreadystatechange comled ... end .......');
     }
}

</script></div><section class="page__comments d-print-none"></section></article><!-- start custom main bottom snippet -->

<!-- end custom main bottom snippet --></div>
            </div></div></div><div class="page__footer d-print-none"><footer class="footer py-4 js-page-footer">
  <div class="main"><div itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Satya Kaveti"><meta itemprop="url" content="/"><meta itemprop="description" content="I am an amazing person."><div class="footer__author-links"><div class="author-links">
  <ul class="menu menu--nowrap menu--inline"></ul>
</div>
</div>
    </div><div class="site-info mt-2">
      <div>© SatyaCodes 2020 ,
        <a title="Satya Kaveti" href="about/">Satya Kaveti's Writing</a>.
		<span>| <a href="about/">About Me</a> &nbsp |  </span>
		<span><a href="/terms.html">Terms</a> &nbsp |  </span>
		<span><a href="/contact.html">Contact</a> &nbsp |  </span>
		<span><a href="http://www.satyacodesapps.ml/" target="_blank">Our Apps</a> &nbsp |  </span>
		<span><a href="https://www.facebook.com/isatyakaveti" target="_blank"><i class="fab fa-facebook-f"></i></a> &nbsp |  </span>
		<span><a href="https://www.youtube.com/" target="_blank"><i class="fab fa-youtube-square"></i></a> &nbsp |  </span>
		<span><a href="https://in.linkedin.com/in/satyakaveti"target="_blank"><i class="fab fa-linkedin-in"></i></a> &nbsp | 
		<span>[ 
		<!-- Start of WebFreeCounter Code -->
<a href="http://www.statworker.com/" target="_blank"><img src="https://www.webfreecounter.com/hit.php?id=gfpapx&nd=7&style=2" border="0" alt="statworker.com"></a>
<!-- End of WebFreeCounter Code -->
</span>
<span><a href="https://statcounter.com/p12408441/?guest=1" target="_blank"> ]</a></span>


      </div>
    </div>
  </div>
</footer></div></div>
    </div></div></div><script>(function() {
  var SOURCES = window.TEXT_VARIABLES.sources;
  window.Lazyload.js(SOURCES.jquery, function() {
    var $body = $('body'), $window = $(window);
    var $pageRoot = $('.js-page-root'), $pageMain = $('.js-page-main');
    var activeCount = 0;
    function modal(options) {
      var $root = this, visible, onChange, hideWhenWindowScroll = false;
      var scrollTop;
      function setOptions(options) {
        var _options = options || {};
        visible = _options.initialVisible === undefined ? false : show;
        onChange = _options.onChange;
        hideWhenWindowScroll = _options.hideWhenWindowScroll;
      }
      function init() {
        setState(visible);
      }
      function setState(isShow) {
        if (isShow === visible) {
          return;
        }
        visible = isShow;
        if (visible) {
          activeCount++;
          scrollTop = $(window).scrollTop() || $pageMain.scrollTop();
          $root.addClass('modal--show');
          $pageMain.scrollTop(scrollTop);
          activeCount === 1 && ($pageRoot.addClass('show-modal'), $body.addClass('of-hidden'));
          hideWhenWindowScroll && window.hasEvent('touchstart') && $window.on('scroll', hide);
          $window.on('keyup', handleKeyup);
        } else {
          activeCount > 0 && activeCount--;
          $root.removeClass('modal--show');
          $window.scrollTop(scrollTop);
          activeCount === 0 && ($pageRoot.removeClass('show-modal'), $body.removeClass('of-hidden'));
          hideWhenWindowScroll && window.hasEvent('touchstart') && $window.off('scroll', hide);
          $window.off('keyup', handleKeyup);
        }
        onChange && onChange(visible);
      }
      function show() {
        setState(true);
      }
      function hide() {
        setState(false);
      }
      function handleKeyup(e) {
        // Char Code: 27  ESC
        if (e.which ===  27) {
          hide();
        }
      }
      setOptions(options);
      init();
      return {
        show: show,
        hide: hide,
        $el: $root
      };
    }
    $.fn.modal = modal;
  });
})();
</script><div class="modal d-print-none js-page-gallery-modal"><div class="gallery"></div></div><div class="modal modal--overflow page__search-modal d-print-none js-page-search-modal"><script>
(function () {
  var SOURCES = window.TEXT_VARIABLES.sources;
  window.Lazyload.js(SOURCES.jquery, function() {
    // search panel
    var search = (window.search || (window.search = {}));
    var useDefaultSearchBox = window.useDefaultSearchBox === undefined ?
      true : window.useDefaultSearchBox ;

    var $searchModal = $('.js-page-search-modal');
    var $searchToggle = $('.js-search-toggle');
    var searchModal = $searchModal.modal({ onChange: handleModalChange, hideWhenWindowScroll: true });
    var modalVisible = false;
    search.searchModal = searchModal;

    var $searchBox = null;
    var $searchInput = null;
    var $searchClear = null;

    function getModalVisible() {
      return modalVisible;
    }
    search.getModalVisible = getModalVisible;

    function handleModalChange(visible) {
      modalVisible = visible;
      if (visible) {
        search.onShow && search.onShow();
        useDefaultSearchBox && $searchInput[0] && $searchInput[0].focus();
      } else {
        search.onShow && search.onHide();
        useDefaultSearchBox && $searchInput[0] && $searchInput[0].blur();
        setTimeout(function() {
          useDefaultSearchBox && ($searchInput.val(''), $searchBox.removeClass('not-empty'));
          search.clear && search.clear();
          window.pageAsideAffix && window.pageAsideAffix.refresh();
        }, 400);
      }
    }

    $searchToggle.on('click', function() {
      modalVisible ? searchModal.hide() : searchModal.show();
    });
    // Char Code: 83  S, 191 /
    $(window).on('keyup', function(e) {
      if (!modalVisible && !window.isFormElement(e.target || e.srcElement) && (e.which === 83 || e.which === 191)) {
        modalVisible || searchModal.show();
      }
    });

    if (useDefaultSearchBox) {
      $searchBox = $('.js-search-box');
      $searchInput = $searchBox.children('input');
      $searchClear = $searchBox.children('.js-icon-clear');
      search.getSearchInput = function() {
        return $searchInput.get(0);
      };
      search.getVal = function() {
        return $searchInput.val();
      };
      search.setVal = function(val) {
        $searchInput.val(val);
      };

      $searchInput.on('focus', function() {
        $(this).addClass('focus');
      });
      $searchInput.on('blur', function() {
        $(this).removeClass('focus');
      });
      $searchInput.on('input', window.throttle(function() {
        var val = $(this).val();
        if (val === '' || typeof val !== 'string') {
          search.clear && search.clear();
        } else {
          $searchBox.addClass('not-empty');
          search.onInputNotEmpty && search.onInputNotEmpty(val);
        }
      }, 400));
      $searchClear.on('click', function() {
        $searchInput.val(''); $searchBox.removeClass('not-empty');
        search.clear && search.clear();
      });
    }
  });
})();
</script><div class="search search--dark">
  <div class="main">
    <div class="search__header">Search</div>
    <div class="search-bar">
      <div class="search-box js-search-box">
        <div class="search-box__icon-search"><i class="fas fa-search"></i></div>
        <input type="text" />
        <div class="search-box__icon-clear js-icon-clear">
          <a><i class="fas fa-times"></i></a>
        </div>
      </div>
      <button class="button button--theme-dark button--pill search__cancel js-search-toggle">
        Cancel</button>
    </div>
    <div class="search-result js-search-result"></div>
  </div>
</div>
<script>var SOURCES = window.TEXT_VARIABLES.sources;
var PAHTS = window.TEXT_VARIABLES.paths;
window.Lazyload.js([SOURCES.jquery, PAHTS.search_js], function() {
  var search = (window.search || (window.search = {}));
  var searchData = window.TEXT_SEARCH_DATA || {};

  function memorize(f) {
    var cache = {};
    return function () {
      var key = Array.prototype.join.call(arguments, ',');
      if (key in cache) return cache[key];
      else return cache[key] = f.apply(this, arguments);
    };
  }

  /// search
  function searchByQuery(query) {
    var i, j, key, keys, cur, _title, result = {};
    keys = Object.keys(searchData);
    for (i = 0; i < keys.length; i++) {
      key = keys[i];
      for (j = 0; j < searchData[key].length; j++) {
        cur = searchData[key][j], _title = cur.title;
        if ((result[key] === undefined || result[key] && result[key].length < 4 )
          && _title.toLowerCase().indexOf(query.toLowerCase()) >= 0) {
          if (result[key] === undefined) {
            result[key] = [];
          }
          result[key].push(cur);
        }
      }
    }
    return result;
  }

  var renderHeader = memorize(function(header) {
    return $('<p class="search-result__header">' + header + '</p>');
  });

  var renderItem = function(index, title, url) {
    return $('<li class="search-result__item" data-index="' + index + '"><a class="button" href="' + url + '">' + title + '</a></li>');
  };

  function render(data) {
    if (!data) { return null; }
    var $root = $('<ul></ul>'), i, j, key, keys, cur, itemIndex = 0;
    keys = Object.keys(data);
    for (i = 0; i < keys.length; i++) {
      key = keys[i];
      $root.append(renderHeader(key));
      for (j = 0; j < data[key].length; j++) {
        cur = data[key][j];
        $root.append(renderItem(itemIndex++, cur.title, cur.url));
      }
    }
    return $root;
  }

  // search box
  var $result = $('.js-search-result'), $resultItems;
  var lastActiveIndex, activeIndex;

  function clear() {
    $result.html(null);
    $resultItems = $('.search-result__item'); activeIndex = 0;
  }
  function onInputNotEmpty(val) {
    $result.html(render(searchByQuery(val)));
    $resultItems = $('.search-result__item'); activeIndex = 0;
    $resultItems.eq(0).addClass('active');
  }

  search.clear = clear;
  search.onInputNotEmpty = onInputNotEmpty;

  function updateResultItems() {
    lastActiveIndex >= 0 && $resultItems.eq(lastActiveIndex).removeClass('active');
    activeIndex >= 0 && $resultItems.eq(activeIndex).addClass('active');
  }

  function moveActiveIndex(direction) {
    var itemsCount = $resultItems ? $resultItems.length : 0;
    if (itemsCount > 1) {
      lastActiveIndex = activeIndex;
      if (direction === 'up') {
        activeIndex = (activeIndex - 1 + itemsCount) % itemsCount;
      } else if (direction === 'down') {
        activeIndex = (activeIndex + 1 + itemsCount) % itemsCount;
      }
      updateResultItems();
    }
  }

  // Char Code: 13  Enter, 37  ⬅, 38  ⬆, 39  ➡, 40  ⬇
  $(window).on('keyup', function(e) {
    var modalVisible = search.getModalVisible && search.getModalVisible();
    if (modalVisible) {
      if (e.which === 38) {
        modalVisible && moveActiveIndex('up');
      } else if (e.which === 40) {
        modalVisible && moveActiveIndex('down');
      } else if (e.which === 13) {
        modalVisible && $resultItems && activeIndex >= 0 && $resultItems.eq(activeIndex).children('a')[0].click();
      }
    }
  });

  $result.on('mouseover', '.search-result__item > a', function() {
    var itemIndex = $(this).parent().data('index');
    itemIndex >= 0 && (lastActiveIndex = activeIndex, activeIndex = itemIndex, updateResultItems());
  });
});
</script></div></div>


<script>(function() {
  var SOURCES = window.TEXT_VARIABLES.sources;
  window.Lazyload.js(SOURCES.jquery, function() {
    function scrollToAnchor(anchor, duration, callback) {
      var $root = this;
      $root.animate({ scrollTop: $(anchor).position().top }, duration, function() {
        window.history.replaceState(null, '', window.location.href.split('#')[0] + anchor);
        callback && callback();
      });
    }
    $.fn.scrollToAnchor = scrollToAnchor;
  });
})();
(function() {
  var SOURCES = window.TEXT_VARIABLES.sources;
  window.Lazyload.js(SOURCES.jquery, function() {
    function affix(options) {
      var $root = this, $window = $(window), $scrollTarget, $scroll,
        offsetBottom = 0, scrollTarget = window, scroll = window.document, disabled = false, isOverallScroller = true,
        rootTop, rootLeft, rootHeight, scrollBottom, rootBottomTop,
        hasInit = false, curState;

      function setOptions(options) {
        var _options = options || {};
        _options.offsetBottom && (offsetBottom = _options.offsetBottom);
        _options.scrollTarget && (scrollTarget = _options.scrollTarget);
        _options.scroll && (scroll = _options.scroll);
        _options.disabled !== undefined && (disabled = _options.disabled);
        $scrollTarget = $(scrollTarget);
        isOverallScroller = window.isOverallScroller($scrollTarget[0]);
        $scroll = $(scroll);
      }
      function preCalc() {
        top();
        rootHeight = $root.outerHeight();
        rootTop = $root.offset().top + (isOverallScroller ? 0 :  $scrollTarget.scrollTop());
        rootLeft = $root.offset().left;
      }
      function calc(needPreCalc) {
        needPreCalc && preCalc();
        scrollBottom = $scroll.outerHeight() - offsetBottom - rootHeight;
        rootBottomTop = scrollBottom - rootTop;
      }
      function top() {
        if (curState !== 'top') {
          $root.removeClass('fixed').css({
            left: 0,
            top: 0
          });
          curState = 'top';
        }
      }
      function fixed() {
        if (curState !== 'fixed') {
          $root.addClass('fixed').css({
            left: rootLeft + 'px',
            top: 0
          });
          curState = 'fixed';
        }
      }
      function bottom() {
        if (curState !== 'bottom') {
          $root.removeClass('fixed').css({
            left: 0,
            top: rootBottomTop + 'px'
          });
          curState = 'bottom';
        }
      }
      function setState() {
        var scrollTop = $scrollTarget.scrollTop();
        if (scrollTop >= rootTop && scrollTop <= scrollBottom) {
          fixed();
        } else if (scrollTop < rootTop) {
          top();
        } else {
          bottom();
        }
      }
      function init() {
        if(!hasInit) {
          var interval, timeout;
          calc(true); setState();
          // run calc every 100 millisecond
          interval = setInterval(function() {
            calc();
          }, 100);
          timeout = setTimeout(function() {
            clearInterval(interval);
          }, 45000);
          window.pageLoad.then(function() {
            setTimeout(function() {
              clearInterval(interval);
              clearTimeout(timeout);
            }, 3000);
          });
          $scrollTarget.on('scroll', function() {
            disabled || setState();
          });
          $window.on('resize', function() {
            disabled || (calc(true), setState());
          });
          hasInit = true;
        }
      }

      setOptions(options);
      if (!disabled) {
        init();
      }
      $window.on('resize', window.throttle(function() {
        init();
      }, 200));
      return {
        setOptions: setOptions,
        refresh: function() {
          calc(true, { animation: false }); setState();
        }
      };
    }
    $.fn.affix = affix;
  });
})();
(function() {
  var SOURCES = window.TEXT_VARIABLES.sources;
  window.Lazyload.js(SOURCES.jquery, function() {
    function toc(options) {
      var $root = this, $window = $(window), $scrollTarget, $scroller, $tocUl = $('<ul class="toc toc--ellipsis"></ul>'), $tocLi, $headings, $activeLast, $activeCur,
        selectors = 'h1,h2,h3', container = 'body', scrollTarget = window, scroller = 'html, body', disabled = false,
        headingsPos, scrolling = false, hasRendered = false, hasInit = false;

      function setOptions(options) {
        var _options = options || {};
        _options.selectors && (selectors = _options.selectors);
        _options.container && (container = _options.container);
        _options.scrollTarget && (scrollTarget = _options.scrollTarget);
        _options.scroller && (scroller = _options.scroller);
        _options.disabled !== undefined && (disabled = _options.disabled);
        $headings = $(container).find(selectors).filter('[id]');
        $scrollTarget = $(scrollTarget);
        $scroller = $(scroller);
      }
      function calc() {
        headingsPos = [];
        $headings.each(function() {
          headingsPos.push(Math.floor($(this).position().top));
        });
      }
      function setState(element, disabled) {
        var scrollTop = $scrollTarget.scrollTop(), i;
        if (disabled || !headingsPos || headingsPos.length < 1) { return; }
        if (element) {
          $activeCur = element;
        } else {
          for (i = 0; i < headingsPos.length; i++) {
            if (scrollTop >= headingsPos[i]) {
              $activeCur = $tocLi.eq(i);
            } else {
              $activeCur || ($activeCur = $tocLi.eq(i));
              break;
            }
          }
        }
        $activeLast && $activeLast.removeClass('active');
        ($activeLast = $activeCur).addClass('active');
      }
      function render() {
        if(!hasRendered) {
          $root.append($tocUl);
          $headings.each(function() {
            var $this = $(this);
            $tocUl.append($('<li></li>').addClass('toc-' + $this.prop('tagName').toLowerCase())
              .append($('<a></a>').text($this.text()).attr('href', '#' + $this.prop('id'))));
          });
          $tocLi = $tocUl.children('li');
          $tocUl.on('click', 'a', function(e) {
            e.preventDefault();
            var $this = $(this);
            scrolling = true;
            setState($this.parent());
            $scroller.scrollToAnchor($this.attr('href'), 400, function() {
              scrolling = false;
            });
          });
        }
        hasRendered = true;
      }
      function init() {
        var interval, timeout;
        if(!hasInit) {
          render(); calc(); setState(null, scrolling);
          // run calc every 100 millisecond
          interval = setInterval(function() {
            calc();
          }, 100);
          timeout = setTimeout(function() {
            clearInterval(interval);
          }, 45000);
          window.pageLoad.then(function() {
            setTimeout(function() {
              clearInterval(interval);
              clearTimeout(timeout);
            }, 3000);
          });
          $scrollTarget.on('scroll', function() {
            disabled || setState(null, scrolling);
          });
          $window.on('resize', window.throttle(function() {
            if (!disabled) {
              render(); calc(); setState(null, scrolling);
            }
          }, 100));
        }
        hasInit = true;
      }

      setOptions(options);
      if (!disabled) {
        init();
      }
      $window.on('resize', window.throttle(function() {
        init();
      }, 200));
      return {
        setOptions: setOptions
      };
    }
    $.fn.toc = toc;
  });
})();
(function() {(function() {
  var SOURCES = window.TEXT_VARIABLES.sources;
  window.Lazyload.js(SOURCES.jquery, function() {
    function swiper(options) {
      var $window = $(window), $root = this, $swiperWrapper, $swiperSlides, $swiperButtonPrev, $swiperButtonNext,
        initialSlide, animation, onChange, onChangeEnd,
        rootWidth, count, preIndex, curIndex, translateX, CRITICAL_ANGLE = Math.PI / 3;

      function setOptions(options) {
        var _options = options || {};
        initialSlide = _options.initialSlide || 0;
        animation = _options.animation === undefined && true;
        onChange = onChange || _options.onChange;
        onChangeEnd = onChangeEnd || _options.onChangeEnd;
      }

      function init() {
        $swiperWrapper = $root.find('.swiper__wrapper');
        $swiperSlides = $root.find('.swiper__slide');
        $swiperButtonPrev = $root.find('.swiper__button--prev');
        $swiperButtonNext = $root.find('.swiper__button--next');
        animation && $swiperWrapper.addClass('swiper__wrapper--animation');
        calc(true);
      }

      function preCalc() {
        rootWidth = $root.width();
        count = $swiperWrapper.children('.swiper__slide').length;
        if (count < 2) {
          $swiperButtonPrev.addClass('d-none');
          $swiperButtonNext.addClass('d-none');
        }
        curIndex = initialSlide || 0;
        translateX = getTranslateXFromCurIndex();
      }

      var calc = (function() {
        var preAnimation, $swiperSlide, $preSwiperSlide;
        return function (needPreCalc, params) {
          needPreCalc && preCalc();
          var _animation = (params && params.animation !== undefined) ? params.animation : animation;
          if (preAnimation === undefined || preAnimation !== _animation) {
            preAnimation = _animation ? $swiperWrapper.addClass('swiper__wrapper--animation') :
              $swiperWrapper.removeClass('swiper__wrapper--animation');
          }
          if (preIndex !== curIndex) {
            ($preSwiperSlide = $swiperSlides.eq(preIndex)).removeClass('active');
            ($swiperSlide = $swiperSlides.eq(curIndex)).addClass('active');
            onChange && onChange(curIndex, $swiperSlides.eq(curIndex), $swiperSlide, $preSwiperSlide);
            if (onChangeEnd) {
              if (_animation) {
                setTimeout(function() {
                  onChangeEnd(curIndex, $swiperSlides.eq(curIndex), $swiperSlide, $preSwiperSlide);
                }, 400);
              } else {
                onChangeEnd(curIndex, $swiperSlides.eq(curIndex), $swiperSlide, $preSwiperSlide);
              }
            }
            preIndex = curIndex;
          }
          $swiperWrapper.css('transform', 'translate(' + translateX + 'px, 0)');
          if (count > 1) {
            if (curIndex <= 0) {
              $swiperButtonPrev.addClass('disabled');
            } else {
              $swiperButtonPrev.removeClass('disabled');
            }
            if (curIndex >= count - 1) {
              $swiperButtonNext.addClass('disabled');
            } else {
              $swiperButtonNext.removeClass('disabled');
            }
          }
        };
      })();

      function getTranslateXFromCurIndex() {
        return curIndex <= 0 ? 0 : - rootWidth * curIndex;
      }

      function moveToIndex(index ,params) {
        preIndex = curIndex;
        curIndex = index;
        translateX = getTranslateXFromCurIndex();
        calc(false, params);
      }

      function move(type) {
        var nextIndex = curIndex, unstableTranslateX;
        if (type === 'prev') {
          nextIndex > 0 && nextIndex--;
        } else if (type === 'next') {
          nextIndex < count - 1 && nextIndex++;
        }
        if (type === 'cur') {
          moveToIndex(curIndex, { animation: true });
          return;
        }
        unstableTranslateX = translateX % rootWidth !== 0;
        if (nextIndex !== curIndex || unstableTranslateX) {
          unstableTranslateX ? moveToIndex(nextIndex, { animation: true }) : moveToIndex(nextIndex);
        }
      }

      setOptions(options);
      init();
      preIndex = curIndex;

      $swiperButtonPrev.on('click', function(e) {
        e.stopPropagation();
        move('prev');
      });
      $swiperButtonNext.on('click', function(e) {
        e.stopPropagation();
        move('next');
      });
      $window.on('resize', function() {
        calc(true, { animation: false });
      });

      (function() {
        var pageX, pageY, velocityX, preTranslateX = translateX, timeStamp, touching;
        function handleTouchstart(e) {
          var point = e.touches ? e.touches[0] : e;
          pageX = point.pageX;
          pageY = point.pageY;
          velocityX = 0;
          preTranslateX = translateX;
        }
        function handleTouchmove(e) {
          if (e.touches && e.touches.length > 1) {
            return;
          }
          var point = e.touches ? e.touches[0] : e;
          var deltaX = point.pageX - pageX;
          var deltaY = point.pageY - pageY;
          velocityX = deltaX / (e.timeStamp - timeStamp);
          timeStamp = e.timeStamp;
          if (e.cancelable && Math.abs(Math.atan(deltaY / deltaX)) < CRITICAL_ANGLE) {
            touching = true;
            translateX += deltaX;
            calc(false, { animation: false });
          }
          pageX = point.pageX;
          pageY = point.pageY;
        }
        function handleTouchend() {
          touching = false;
          var deltaX = translateX - preTranslateX;
          var distance = deltaX + velocityX * rootWidth;
          if (Math.abs(distance) > rootWidth / 2) {
            distance > 0 ? move('prev') : move('next');
          } else {
            move('cur');
          }
        }
        $swiperWrapper.on('touchstart', handleTouchstart);
        $swiperWrapper.on('touchmove', handleTouchmove);
        $swiperWrapper.on('touchend', handleTouchend);
        $swiperWrapper.on('touchcancel', handleTouchend);

        (function() {
          var pressing = false, moved = false;
          $swiperWrapper.on('mousedown', function(e) {
            pressing = true; handleTouchstart(e);
          });
          $swiperWrapper.on('mousemove', function(e) {
            pressing && (e.preventDefault(), moved = true, handleTouchmove(e));
          });
          $swiperWrapper.on('mouseup', function(e) {
            pressing && (pressing = false, handleTouchend(e));
          });
          $swiperWrapper.on('mouseleave', function(e) {
            pressing && (pressing = false, handleTouchend(e));
          });
          $swiperWrapper.on('click', function(e) {
            moved && (e.stopPropagation(), moved = false);
          });
        })();

        $root.on('touchmove', function(e) {
          if (e.cancelable & touching) {
            e.preventDefault();
          }
        });
      })();

      return {
        setOptions: setOptions,
        previous: function(){
          move('prev');
        },
        next: function(){
          move('next');
        },
        refresh: function() {
          calc(true, { animation: false });
        }
      };
    }
    $.fn.swiper = swiper;
  });
})();
var SOURCES = window.TEXT_VARIABLES.sources;
  window.Lazyload.js(SOURCES.jquery, function() {
    var template =
      '<div class="swiper gallery__swiper">' +
        '<div class="swiper__wrapper">' +
        '</div>' +
        '<div class="swiper__button swiper__button--prev fas fa-chevron-left"></div>' +
        '<div class="swiper__button swiper__button--next fas fa-chevron-right"></div>' +
      '</div>';
    function setState($item, zoom, translate) {
      $item.css('transform', 'scale(' + zoom + ') translate(' + translate.x +  'px,' + translate.y + 'px)');
    }
    function Gallery(root, items) {
      this.$root = $(root);
      this.$swiper = null;
      this.$swiperWrapper = null;
      this.$activeItem = null;
      this.$items = [];
      this.contentWidth = 0;
      this.contentHeight = 0;
      this.swiper = null;
      this.items = items;
      this.disabled = false;
      this.curIndex = 0;
      this.touchCenter = null;
      this.lastTouchCenter = null;
      this.zoomRect = null;
      this.lastZoomRect = null;
      this.lastTranslate = null;
      this.translate = null;
      this.lastZoom = 1;
      this.preZoom = 1;
      this.zoom = 1;
    }
    Gallery.prototype.init = function() {
      var i, item, items = this.items, size, self = this, touchstartFingerCount = 0;
      this.$root.append(template);
      this.$swiper = this.$root.find('.gallery__swiper');
      this.$swiperWrapper = this.$root.find('.swiper__wrapper');
      this.contentWidth = this.$swiperWrapper && this.$swiperWrapper.width();
      this.contentHeight = this.$swiperWrapper && this.$swiperWrapper.height();
      for (i = 0; i < items.length; i++) {
        item = items[i];
        size = this._calculateImageSize(item.w, item.h);
        this.$items.push($(
          '<div class="swiper__slide">' +
            '<div class="gallery-item">' +
              '<div class="gallery-item__content">' +
                '<img src="' + item.src + '" style="width:' + size.w + 'px;height:' + size.h +  'px"/>' +
              '</div>' +
            '</div>' +
          '</div>'
        ));
      }
      this.$swiperWrapper && this.$swiperWrapper.append(this.$items);
      this.swiper = this.$swiper && this.$swiper.swiper({
        onChangeEnd: function() {
          self._handleChangeEnd.apply(self, Array.prototype.slice.call(arguments));
        }
      });
      $(window).on('resize', function() {
        if (self.disabled) { return; }
        self._resizeImageSize();
      });
      // Char Code: 37  ⬅, 39  ➡
      $(window).on('keyup', function(e) {
        if (window.isFormElement(e.target || e.srcElement) || self.disabled) { return; }
        if (e.which === 37) {
          self.swiper && self.swiper.previous();
        } else if (e.which === 39) {
          self.swiper && self.swiper.next();
        }
      });
      function getRect(touch0, touch1) {
        return {
          o: {
            x: (touch0.pageX + touch1.pageX) / 2,
            y: (touch0.pageY + touch1.pageY) / 2
          },
          w: Math.abs(touch0.pageX - touch1.pageX),
          h: Math.abs(touch0.pageY - touch1.pageY)
        };
      }
      function getTouches(e) {
        return e.touches || e;
      }
      function getTouchesCount(e) {
        if (e.touches) {
          return e.touches.length;
        } else {
          return 1;
        }
      }
      this.$swiperWrapper.on('touchstart', function(e) {
        var touch0, touch1, rect;
        touchstartFingerCount = getTouchesCount(e);
        if (touchstartFingerCount > 1) {
          touch0 = e.touches[0];
          touch1 = e.touches[1];
          rect = getRect(touch0, touch1);
          self.lastZoomRect = { w: rect.w, h: rect.h };
          self.lastTouchCenter = rect.o;
        } else {
          var touch = getTouches(e)[0];
          self.lastTouchCenter = { x: touch.pageX, y: touch.pageY };
        }
      });
      this.$swiperWrapper.on('touchmove', function(e) {
        if (touchstartFingerCount === getTouchesCount(e)) {
          if (touchstartFingerCount > 1) {
            var touch0 = e.touches[0];
            var touch1 = e.touches[1];
            var rect = getRect(touch0, touch1);
            self.zoomRect = { w: rect.w, h: rect.h };
            self.touchCenter = rect.o;
            self._zoom(); self._translate();
            setState(self.$activeItem, self.zoom, self.translate);
          } else {
            var touch = getTouches(e)[0];
            self.touchCenter = { x: touch.pageX, y: touch.pageY };
            self._translate();
            setState(self.$activeItem, self.zoom, self.translate);
          }
        }
      });
      this.$swiperWrapper.on('touchend', function(e) {
        self.lastZoom = self.zoom;
        self.lastTranslate = self.translate;
        touchstartFingerCount = 0;
      });
      this.$root.on('touchmove', function(e) {
        if (self.disabled) { return; }
        e.preventDefault();
      });
    };

    Gallery.prototype._translate = function() {
      this.translate = this.touchCenter && this.lastTouchCenter && this.lastTranslate ? {
        x: (this.touchCenter.x - this.lastTouchCenter.x) / this.zoom + this.lastTranslate.x,
        y: (this.touchCenter.y - this.lastTouchCenter.y) / this.zoom + this.lastTranslate.y
      } : { x: 0, y: 0 };
    }
    Gallery.prototype._zoom = function() {
      this.zoom = (this.zoomRect.w + this.zoomRect.h) / (this.lastZoomRect.w + this.lastZoomRect.h) * this.lastZoom;
      this.zoom > 1 ? this.$activeItem.addClass('zoom') : this.$activeItem.removeClass('zoom');
      this.preZoom = this.zoom;
    }

    Gallery.prototype._calculateImageSize = function(w, h) {
      var scale = 1;
      if (this.contentWidth > 0 && this.contentHeight > 0 && w > 0 && h > 0) {
        scale = Math.min(
          Math.min(w, this.contentWidth) / w,
          Math.min(h, this.contentHeight) / h);
      }
      return { w: Math.floor(w * scale), h: Math.floor(h * scale) };
    };

    Gallery.prototype._resizeImageSize = function() {
      var i, $item, $items = this.$items, item, size;
      this.contentWidth = this.$swiperWrapper && this.$swiperWrapper.width();
      this.contentHeight = this.$swiperWrapper && this.$swiperWrapper.height();
      if ($items.length < 1) { return; }
      for (i = 0; i < $items.length; i++) {
        item = this.items[i], $item = $items[i];
        size = this._calculateImageSize(item.w, item.h);
        item.width = size.w; item.height = size.h;
        $item && $item.find('img').css({ width: size.w, height: size.h });
      }
    };
    Gallery.prototype._handleChangeEnd = function(index, $dom, preIndex, $preDom) {
      this.curIndex = index;
      this.lastZoomRect = null; this.lastZoomRect = null;
      this.lastTranslate = this.translate = { x: 0, y:0 };
      this.lastZoom = this.preZoom = this.zoom = 1;
      this.$activeItem = $dom.find('.gallery-item__content');
      setState($preDom.find('.gallery-item__content'), this.zoom, this.translate);
    };

    Gallery.prototype.refresh = function() {
      this.swiper && this.swiper.refresh();
      this._resizeImageSize();
    };
    Gallery.prototype.setOptions = function(options) {
      this.disabled = options.disabled;
      this.swiper && this.swiper.setOptions(options);
    };
    window.Gallery = Gallery;
  });
})();(function() {
  window.imagesLoad = function(images) {
    images = images || document.getElementsByTagName('img');
    var imagesCount = images.length, loadedCount = 0, image;
    var i, j, loaded = false, cbs = [];
    imagesCount < 1 && (loaded = true);
    for (i = 0; i < imagesCount; i++) {
      image = images[i];
      image.complete ? handleImageLoad() : image.addEventListener('load', handleImageLoad);
    }
    function handleImageLoad() {
      loadedCount++;
      if (loadedCount === imagesCount) {
        loaded = true;
        if (cbs.length > 0) {
          for (j = 0; j < cbs.length; j++) {
            cbs[j]();
          }
        }
      }
    }
    return {
      then: function(cb) {
        cb && (loaded ? cb() : (cbs.push(cb)));
      }
    };
  };
})();
(function () {
  var SOURCES = window.TEXT_VARIABLES.sources;
  window.Lazyload.js(SOURCES.jquery, function() {
    var $pageGalleryModal = $('.js-page-gallery-modal');
    var $images = $('.page__content').find('img:not(.lightbox-ignore)');
    window.imagesLoad($images).then(function() {
      /* global Gallery */
      var pageGalleryModal = $pageGalleryModal.modal({ onChange: handleModalChange });
      var gallery = null;
      var modalVisible = false;
      var i, items = [], image, item;
      if($images && $images.length > 0) {
        for (i = 0; i < $images.length; i++) {
          image = $images.eq(i);
          if (image.get(0).naturalWidth > 800) {
            items.push({ src: image.attr('src'), w: image.get(0).naturalWidth, h: image.get(0).naturalHeight, $el: image});
          }
        }
      }

      if(items.length > 0) {
        gallery = new Gallery('.gallery', items);
        gallery.setOptions({ disabled: !modalVisible });
        gallery.init();
        for (i = 0; i < items.length; i++) {
          item = items[i];
          item.$el && (item.$el.addClass('popup-image'), item.$el.on('click', (function() {
            var index = i;
            return function() {
              pageGalleryModal.show();
              gallery.setOptions({ initialSlide: index });
              gallery.refresh(true, { animation: false });
            };
          })()));
        }
      }

      function handleModalChange(visible) {
        modalVisible = visible;
        gallery && gallery.setOptions({ disabled: !modalVisible });
      }

      $pageGalleryModal.on('click', function() {
        pageGalleryModal.hide();
      });
    });
  });
})();/*(function () {

})();*/
</script><script>(function() {
  var SOURCES = window.TEXT_VARIABLES.sources;

  window.Lazyload.js(SOURCES.jquery, function() {
    var $pageMask = $('.js-page-mask');
    var $pageRoot = $('.js-page-root');
    var $sidebarShow = $('.js-sidebar-show');
    var $sidebarHide = $('.js-sidebar-hide');

    function freeze(e) {
      if (e.target === $pageMask[0]) {
        e.preventDefault();
      }
    }
    function stopBodyScrolling(bool) {
      if (bool === true) {
        window.addEventListener('touchmove', freeze, { passive: false });
      } else {
        window.removeEventListener('touchmove', freeze, { passive: false });
      }
    }

    $sidebarShow.on('click', function() {
      stopBodyScrolling(true); $pageRoot.addClass('show-sidebar');
    });
    $sidebarHide.on('click', function() {
      stopBodyScrolling(false); $pageRoot.removeClass('show-sidebar');
    });
  });
})();
</script><script>
  /* toc must before affix, since affix need to konw toc' height. */(function() {
  var SOURCES = window.TEXT_VARIABLES.sources;
  window.Lazyload.js(SOURCES.jquery, function() {
    var $window = $(window), $pageFooter = $('.js-page-footer');
    var $pageAside = $('.js-page-aside');
    var affix;
    var tocDisabled = false;
    var hasSidebar = $('.js-page-root').hasClass('layout--page--sidebar');

    affix = $pageAside.affix({
      offsetBottom: $pageFooter.outerHeight(),
      scrollTarget: hasSidebar ? '.js-page-main' : null,
      scroller: hasSidebar ? '.js-page-main' : null,
      scroll: hasSidebar ? $('.js-page-main').children() : null,
      disabled: tocDisabled
    });

    $window.on('resize', window.throttle(function() {
      affix && affix.setOptions({
        disabled: tocDisabled
      });
    }, 100));

    window.pageAsideAffix = affix;
  });
})();
</script>
    </div>
    <script>(function () {
  var $root = document.getElementsByClassName('root')[0];
  if (window.hasEvent('touchstart')) {
    $root.dataset.isTouch = true;
    document.addEventListener('touchstart', function(){}, false);
  }
})();
</script>
  </body>
</html>